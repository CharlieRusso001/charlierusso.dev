<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Charles (Charlie) Russo – Engineer | Russo Technical Services</title>
  <meta name="description" content="Russo Technical Services by Charles (Charlie) Russo – engineer offering technical help, full‑stack development, prototypes, and manufacturing support." />
  <meta name="keywords" content="Russo Technical Services, Charles Russo engineer, Charlie Russo engineer, technical help, full‑stack developer, prototype manufacturing, charles russo uchicago, charlie russo uchicago, russo uchicago, russo technical, fullstak development services" />
  <link rel="canonical" href="https://charlierusso.dev/" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#000000" />

  <!-- Open Graph / Discord / iMessage -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://charlierusso.dev/" />
  <meta property="og:site_name" content="Technical Help" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:title" content="Charles (Charlie) Russo – Engineer | Russo Technical Services" />
  <meta property="og:description" content="Technical help, engineering, full‑stack development, and prototypes by Charles Russo." />
  <meta property="og:image" content="https://charlierusso.dev/media/charlie.jpg" />
  <meta property="og:image:secure_url" content="https://charlierusso.dev/media/charlie.jpg" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Portrait of Charles Russo" />

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://charlierusso.dev/" />
  <meta property="twitter:title" content="Charles (Charlie) Russo – Engineer | Russo Technical Services" />
  <meta property="twitter:description" content="Technical help, engineering, full‑stack development, and prototypes by Charles Russo." />
  <meta property="twitter:image" content="https://charlierusso.dev/media/charlie.jpg" />
  <meta property="twitter:image:alt" content="Portrait of Charles Russo" />
  
  <!-- Structured Data -->
  <script type="application/ld+json">{
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"Technical Help",
    "url":"https://charlierusso.dev/",
    "alternateName":["Russo Technical Services","Charles Russo Engineer","Charlie Russo Engineer","Russo Technical"],
    "about":"Engineering and software services by Charles (Charlie) Russo",
    "inLanguage":"en-US",
    "keywords":"Russo Technical Services, Charles Russo engineer, Charlie Russo engineer, charles russo uchicago, charlie russo uchicago, russo uchicago, russo technical, fullstak development services"
  }</script>
  <script type="application/ld+json">{
    "@context":"https://schema.org",
    "@type":"Person",
    "name":"Charles Russo",
    "alternateName":["Charlie Russo"],
    "jobTitle":"Engineer",
    "url":"https://charlierusso.dev/",
    "image":"https://charlierusso.dev/media/charlie.jpg",
    "keywords":"Charles Russo engineer, Charlie Russo engineer, charles russo uchicago, charlie russo uchicago, russo uchicago, russo technical, fullstak development services",
    "knowsAbout":["engineering","software development","full‑stack development","prototype manufacturing","Russo Technical Services","UChicago"],
    "worksFor":{
      "@type":"Organization",
      "name":"Russo Technical Services",
      "alternateName":["Technical Help"],
      "url":"https://charlierusso.dev/"
    }
  }</script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <!-- QR Code Styling library -->
  <script src="https://unpkg.com/qr-code-styling@1.9.2/lib/qr-code-styling.js"></script>
  <style>
    :root{
      /* Background Colors */
      --bg-primary: #000;
      --bg-card: rgba(0,0,0,0.72);
      --bg-card-boot: rgba(0,0,0,0.6);
      --bg-overlay: rgba(0,0,0,0.8);
      --bg-form: rgba(0,0,0,0.85);
      --bg-input: rgba(0,0,0,0.8);
      
      /* Text Colors */
      --text-primary: #d7ffe1;
      --text-secondary: #a9f5b3;
      --text-muted: rgb(132, 255, 176);
      --text-hero: #84ffb0;
      --text-terminal: #84ffb0;
      --text-label: #a9f5b3;
      --text-button: #01210c;
      --text-button-secondary: #a9f5b3;
      --text-email: #b6f7c6;
      --text-footer: #7aff8a;
      --text-success: #7fff9f;
      --text-error: #ff6b6b;
      
      /* Accent Colors */
      --accent-primary: #00ff41;
      --accent-secondary: #18ff66;
      --accent-glow: #00ff4147;
      --accent-dim: rgba(0,255,65,0.18);
      --accent-border: rgba(0,255,65,0.25);
      --accent-border-focus: rgba(0,255,65,0.5);
      --accent-shadow: rgba(0,255,65,0.3);
      
      /* Button Colors */
      --btn-primary-bg: linear-gradient(180deg, rgba(0,255,65,0.95), rgba(0,255,65,0.75));
      --btn-primary-border: rgba(0,255,65,0.25);
      --btn-primary-shadow: var(--accent-dim);
      --btn-form-bg: rgba(0,0,0,0.8);
      --btn-form-border: #00ff41;
      --btn-form-hover: rgba(0,255,65,0.1);
      
      /* Border Colors */
      --border-primary: rgba(0,255,65,0.18);
      --border-form: #00ff41;
      --border-input: rgba(0,255,65,0.2);
      --border-input-focus: rgba(0,255,65,0.5);
      
      /* Shadow Colors */
      --shadow-card: 0 20px 70px var(--accent-dim);
      --shadow-form: 0 20px 60px rgba(0,255,65,0.15);
      --shadow-button: 0 10px 30px var(--accent-dim);
      --shadow-glow: 0 0 20px rgba(0,255,65,0.4);
      
      /* Status Colors */
      --status-success: #00ff41;
      --status-loading: #00ff41;
      --status-error: #ff6b6b;
    }
    *{ box-sizing: border-box; }
    html, body{ height:100%; margin:0; background:var(--bg-primary); color:var(--text-primary); }
    body{ overflow:hidden; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial; }

    /* Canvas fills screen behind everything */
    #matrixCanvas{ position:fixed; inset:0; width:100vw; height:100vh; display:block; z-index:0; }

    /* Top label */
    .badge{
      position: absolute; left: 12px; top: 12px; z-index: 5; user-select:none; pointer-events:none;
    }
    .badge .label{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:11px; letter-spacing:.22em; color: var(--text-secondary); opacity:.9; }
    .badge .bar{ height:4px; width:88px; border-radius:999px; background: var(--accent-secondary); margin-top:6px; animation:pulse 1.2s ease-in-out infinite; }
    @keyframes pulse{ 0%,100%{opacity:.35} 50%{opacity:1} }

    /* Boot overlay */
    #boot{
      position:fixed; inset:0; z-index: 10;
      display:grid; place-items:center;
      background: var(--bg-overlay); backdrop-filter: blur(4px);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .boot-card{
      width:min(960px, 92vw);
      background: var(--bg-card-boot);
      border:1px solid var(--accent-border);
      border-radius:24px;
      padding: clamp(20px, 4vw, 48px);
      box-shadow: var(--shadow-card);
      position: relative;
      will-change: transform, opacity, background, border-color, box-shadow;
    }
    .terminal{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono","Courier New", monospace;
      color: var(--text-terminal);
      font-size: clamp(13px, 2.5vw, 16px);
      line-height: 1.5;
      white-space: pre-wrap;
      min-height: 7em;
      will-change: transform, opacity;
      position: relative;
    }
    .hero-text {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-hero);
      font-size: clamp(20px, 4.25vw, 51px);
      line-height: 1.05;
      font-weight: 800;
      text-align: center;
      padding: 0 10px;
      margin: 0 0 8px 0;
      text-shadow: 
        0 0 20px var(--accent-glow),
        0 0 40px var(--accent-dim);
      will-change: transform, opacity;
      position: relative;
    }
    
    .typing-text {
      opacity: 0;
    }
    
    
    .boot-card .hero-text {
      position: absolute;
      inset: 0;
      margin: 0;
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    
    .card-content .hero-text {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    
    .card.show .card-content .hero-text {
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .boot-controls{
      margin-top:12px; display:flex; align-items:center; justify-content:space-between; gap:12px;
      color:#9af4ae; font-size:12px;
    }
    .btn-skip{
      border:1px solid rgba(0,255,65,.35);
      background: rgba(0,255,65,.06);
      color:#c9ffda;
      border-radius:8px;
      padding:6px 12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight:700;
      cursor:pointer;
    }
    .btn-skip:hover{ background: rgba(0,255,65,.12); }
    .cursor{ display:inline-block; width:10px; animation: blink 1s steps(1) infinite; }
    @keyframes blink { 50%{ opacity: 0; } }

    /* CTA Card */
    .wrap{
      position:relative; z-index: 2; 
      height: 100dvh;
      overflow-y: auto;
      overflow-x: hidden;
      scroll-behavior: smooth;
    }
    
    /* Custom Scrollbar for wrap */
    .wrap::-webkit-scrollbar {
      width: 10px;
    }
    
    .wrap::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
    }
    
    .wrap::-webkit-scrollbar-thumb {
      background: var(--accent-border);
      border-radius: 5px;
    }
    
    .wrap::-webkit-scrollbar-thumb:hover {
      background: var(--accent-secondary);
    }

    .card{
      min-height: 100dvh;
      padding: clamp(12px, 3vw, 28px);
      padding-top: clamp(50px, 12vh, 200px);
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: padding-top 2.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .card::before {
      content: '';
      flex: 1;
      min-height: 0;
    }
    
    .card-content {
      width:min(960px, 100%);
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: 24px;
      backdrop-filter: blur(6px);
      box-shadow: var(--shadow-card);
      padding: clamp(20px, 4vw, 48px);
      text-align:center;
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1), 
                  transform 2.5s cubic-bezier(0.16, 1, 0.3, 1);
      flex-shrink: 0;
    }
    
    .card::after {
      content: '';
      flex: 1;
      min-height: 0;
    }
    
    .card.show .card-content{ 
      opacity: 1;
      transform: translateY(0);
    }
    
    
    .card-content .tagline {
      opacity: 0;
      transform: translateY(15px);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1) 0.4s;
    }
    
    .card.show.ready .card-content .tagline {
      opacity: 1;
      transform: translateY(0);
    }
    
    .card-content .actions > * {
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .card-content .actions > *:nth-child(1) {
      transition-delay: 0.6s;
    }
    
    .card-content .actions > *:nth-child(2) {
      transition-delay: 0.8s;
    }
    
    .card-content .actions > *:nth-child(3) {
      transition-delay: 1.0s;
    }
    
    .card.show.ready .card-content .actions > * {
      opacity: 1;
      transform: translateY(0);
    }
    
    .card-content .about-section {
      opacity: 0;
      transform: translateY(20px);
      transition: all 1.0s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .card.show.ready .card-content .about-section {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 1.2s;
    }

    p.tagline{ margin: 0 0 20px; color: var(--text-secondary); font-size: clamp(14px, 2.4vw, 18px); }

    .actions{ display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      min-height:48px; padding: 0 20px;
      border-radius: 999px;
      border: 1px solid var(--btn-primary-border);
      background: var(--btn-primary-bg);
      color: var(--text-button); font-weight:800; text-decoration:none; letter-spacing:.3px;
      box-shadow: var(--shadow-button);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    .btn:hover{ 
      filter: brightness(1.06); 
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 15px 40px var(--accent-dim);
    }
    .email{
      display:inline-flex; align-items:center; gap:10px;
      color: var(--text-email);
      font-weight:600; text-decoration:none;
      border: 1px solid var(--border-input);
      padding: 10px 14px; border-radius: 12px;
      background: var(--btn-form-hover);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    .email:hover{ 
      color: var(--text-primary); 
      border-color: var(--accent-border); 
      background: var(--accent-dim); 
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 10px 30px var(--accent-dim);
    }

    footer{ margin-top: clamp(16px, 2.5vw, 24px); font-size: 12px; color: var(--text-footer); opacity:.9; }

    /* Read More Button - Hidden */
    .btn-read-more {
      display: none;
    }
    
    .btn-read-more:hover {
      background: var(--accent-dim);
      border-color: var(--accent-border);
      color: var(--text-primary);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px var(--accent-dim);
    }
    
    .btn-read-more .arrow-icon {
      transition: transform 0.3s ease;
    }
    
    .btn-read-more.expanded .arrow-icon {
      transform: rotate(180deg);
    }
    
    /* About Section */
    .about-section {
      max-height: 0;
      overflow: hidden;
      transition: max-height 5.0s cubic-bezier(0.16, 1, 0.3, 1), 
                  margin-top 5.0s cubic-bezier(0.16, 1, 0.3, 1);
      margin-top: 0;
    }
    
    .about-section.expanded {
      max-height: 2400px;
      margin-top: 32px;
    }
    
    .about-divider {
      width: 560px;
      max-width: 90%;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
      margin: 0 auto 24px;
      opacity: 0;
      transform: scaleX(0);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
      box-shadow: 0 0 10px var(--accent-glow);
    }
    
    .about-section.expanded .about-divider {
      opacity: 1;
      transform: scaleX(1);
      transition-delay: 0.1s;
    }
    
    .about-divider-bottom {
      margin: 32px auto 24px;
      transition-delay: 1.5s;
    }
    
    .about-title {
      font-size: clamp(24px, 4vw, 36px);
      color: var(--text-hero);
      margin: 0 0 24px 0;
      text-align: center;
      font-weight: 800;
      text-shadow: 0 0 20px var(--accent-glow);
      opacity: 0;
      transform: translateY(20px);
      transition: all 1.0s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .about-section.expanded .about-title {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 0.3s;
    }
    
    .about-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: clamp(16px, 2.5vw, 24px);
      align-items: center;
    }
    
    .about-image-section {
      opacity: 0;
      transform: translateX(-40px);
      transition: all 1.2s cubic-bezier(0.23, 1, 0.32, 1);
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }
    
    .about-section.expanded .about-image-section {
      opacity: 1;
      transform: translateX(0);
      transition-delay: 0.6s;
    }
    
    .about-image {
      width: 100%;
    }
    
        .about-image img {
          width: 68%;
          height: auto;
          border-radius: 16px;
          border: 2px solid var(--border-primary);
          box-shadow: 0 10px 40px var(--accent-dim);
          transition: all 0.1s ease;
          margin: 0 auto;
          display: block;
          transform-style: preserve-3d;
          perspective: 1000px;
          filter: grayscale(100%) sepia(20%) hue-rotate(60deg) brightness(0.95);
        }
        
        .about-image img:hover {
          border-color: var(--accent-border);
          box-shadow: 0 15px 50px var(--accent-shadow);
        }
    
    .linkedin-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: rgba(0,255,65,0.05);
      border: 2px solid var(--border-primary);
      border-radius: 12px;
      color: var(--text-secondary);
      font-weight: 600;
      font-size: 14px;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .linkedin-btn:hover {
      background: var(--accent-dim);
      border-color: var(--accent-border);
      color: var(--text-primary);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px var(--accent-dim);
    }
    
    .linkedin-icon {
      color: var(--accent-primary);
      flex-shrink: 0;
    }
    
    .about-text {
      opacity: 0;
      transform: translateX(40px);
      transition: all 1.2s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .about-section.expanded .about-text {
      opacity: 1;
      transform: translateX(0);
      transition-delay: 0.9s;
    }
    
    .about-text p {
      color: var(--text-secondary);
      font-size: clamp(13px, 2.2vw, 15px);
      line-height: 1.7;
      margin: 0 0 16px 0;
    }
    
    .about-text p:last-child {
      margin-bottom: 0;
    }
    
    /* About Stats Section */
    .about-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: clamp(16px, 3vw, 24px);
      margin-top: 32px;
      opacity: 0;
      transform: translateY(30px);
      transition: all 1.0s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .about-section.expanded .about-stats {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 1.3s;
    }
    
    .stat-card {
      background: rgba(0,255,65,0.05);
      border: 2px solid var(--border-primary);
      border-radius: 16px;
      padding: clamp(20px, 3vw, 32px);
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(0,255,65,0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .stat-card:hover {
      border-color: var(--accent-border);
      background: rgba(0,255,65,0.1);
      transform: translateY(-4px);
      box-shadow: 0 10px 40px var(--accent-dim);
    }
    
    .stat-card:hover::before {
      opacity: 1;
    }
    
    .stat-label {
      color: var(--text-secondary);
      font-size: clamp(12px, 1.8vw, 14px);
      font-weight: 600;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .stat-number {
      color: var(--text-hero);
      font-size: clamp(48px, 8vw, 80px);
      font-weight: 900;
      font-style: italic;
      line-height: 1;
      margin: 8px 0;
      text-shadow: 0 0 20px var(--accent-glow);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      position: relative;
      z-index: 1;
    }
    
    .stat-description {
      color: var(--text-secondary);
      font-size: clamp(13px, 2vw, 16px);
      line-height: 1.4;
      margin-top: 8px;
      font-weight: 500;
    }
    
    /* Trusted By Section */
    .trusted-by-section {
      margin-top: 48px;
      padding-top: 32px;
      border-top: 1px solid var(--border-primary);
      text-align: center;
      opacity: 0;
      transform: translateY(30px);
      transition: all 1.0s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .about-section.expanded .trusted-by-section {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 1.0s;
    }
    
    .trusted-by-title {
      color: var(--text-hero);
      font-size: clamp(20px, 3vw, 28px);
      margin: 0 0 24px 0;
      font-weight: 700;
      text-shadow: 0 0 20px var(--accent-glow);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .clients-logos {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: clamp(24px, 4vw, 48px);
      flex-wrap: wrap;
    }
    
    .client-logo-link {
      display: inline-block;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      opacity: 0.8;
      filter: grayscale(30%) brightness(0.9);
    }
    
    .client-logo-link:hover {
      opacity: 1;
      filter: grayscale(0%) brightness(1);
      transform: translateY(-4px) scale(1.05);
    }
    
    .client-logo {
      max-width: 180px;
      max-height: 80px;
      width: auto;
      height: auto;
      object-fit: contain;
      transition: all 0.3s ease;
    }
    
    /* Mobile and tablet text size increases */
    @media (max-width: 768px) and (min-width: 481px){
      .hero-text { font-size: clamp(30px, 6.5vw, 76px); }
      p.tagline { font-size: clamp(11px, 1.9vw, 14px); }
    }

    @media (max-width: 480px){
      .actions{ gap:10px; }
      .btn{ width:100%; min-height:52px; font-size:16px; }
      .email{ width:100%; justify-content:center; }
      
      /* Mobile text size increases */
      .hero-text { font-size: clamp(40px, 8.5vw, 102px); }
      p.tagline { font-size: clamp(11px, 1.9vw, 14px); }
      
      /* Mobile line breaks for hero text */
      .typing-text .line1,
      .typing-text .line2,
      .typing-text .line3 {
        display: block;
      }
      
      /* Mobile line breaks for tagline text */
      .tagline-line1,
      .tagline-line2 {
        display: block;
        white-space: nowrap;
      }
      
      /* Mobile About Section */
      .btn-read-more {
        width: 100%;
        justify-content: center;
        font-size: 16px;
      }
      
      .about-content {
        grid-template-columns: 1fr;
        gap: 24px;
      }
      
      .about-image-section {
        order: 2;
      }
      
      .about-text {
        order: 1;
      }
      
      .about-section.expanded {
        max-height: 2500px;
      }
      
      /* Mobile Stats Section */
      .about-stats {
        grid-template-columns: 1fr;
        gap: 16px;
      }
      
      /* Mobile Trusted By Section */
      .trusted-by-section {
        margin-top: 32px;
        padding-top: 24px;
      }
      
      .clients-logos {
        gap: 20px;
      }
      
      .client-logo {
        max-width: 140px;
        max-height: 60px;
      }
    }
    
    /* Tablet About Section */
    @media (max-width: 768px) {
      .about-content {
        grid-template-columns: 1fr;
        gap: 28px;
      }
      
      .about-image-section {
        order: 2;
      }
      
      .about-text {
        order: 1;
      }
      
      .about-section.expanded {
        max-height: 2200px;
      }
      
      /* Tablet Trusted By Section */
      .trusted-by-section {
        margin-top: 40px;
        padding-top: 28px;
      }
      
      .clients-logos {
        gap: 32px;
      }
      
      .client-logo {
        max-width: 160px;
        max-height: 70px;
      }
    }

    /* Terminal Form Modal */
    #formModal{
      position: fixed; inset: 0; z-index: 20;
      display: grid; place-items: center; padding: 20px;
      background: rgba(0,0,0,0);
      backdrop-filter: blur(0px);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  visibility 0s linear 0.5s;
    }
    #formModal.show{ 
      opacity: 1;
      visibility: visible;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .form-container{
      width: min(700px, 100%); max-height: 90vh; overflow-y: auto;
      background: var(--bg-form);
      border: 2px solid var(--border-form);
      border-radius: 12px;
      padding: clamp(16px, 3vw, 24px);
      box-shadow: 
        0 30px 100px rgba(0,255,65,0.25),
        0 10px 40px rgba(0,0,0,0.8),
        0 0 0 1px rgba(0,255,65,0.1);
      position: relative;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      opacity: 0;
      transform: scale(0.7) translateY(60px);
      transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1);
      will-change: transform, opacity;
    }
    #formModal.show .form-container{
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    .form-header{
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 20px; padding-bottom: 12px;
      border-bottom: 1px solid #00ff41;
    }
    .form-title{
      font-size: clamp(16px, 3vw, 20px);
      color: var(--text-hero); margin: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-shadow: var(--shadow-glow);
      letter-spacing: 1px;
    }
    .form-title:before{ content: "> "; }
    .close-btn{
      background: var(--bg-input); 
      border: 1px solid var(--border-form); 
      color: var(--text-hero);
      font-size: 16px; cursor: pointer; 
      padding: 4px 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      transition: all 0.2s;
    }
    .close-btn:hover{ 
      background: var(--btn-form-hover); 
      box-shadow: var(--shadow-glow);
    }
    
    .form-group{
      margin-bottom: 16px;
      transform: translateX(-40px);
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .form-group.animate-in{
      transform: translateX(0);
      opacity: 1;
    }
    
    .form-label{
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.4s ease-out;
    }
    .form-label.animate-in{
      opacity: 1;
      transform: translateX(0);
    }
    
    .form-input, .form-textarea, .form-select{
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .form-input.animate-in, .form-textarea.animate-in, .form-select.animate-in{
      opacity: 1;
      transform: translateY(0);
    }
    
    .form-label{
      display: block; margin-bottom: 6px;
      color: var(--text-label); font-weight: 400;
      font-size: 13px; letter-spacing: 0.5px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    .form-label:before{ content: "$ "; color: var(--text-hero); }
    
    .form-input, .form-textarea, .form-select{
      width: 100%; padding: 10px 12px;
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      border-radius: 0; color: var(--text-muted);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 13px;
      box-shadow: inset 0 0 10px var(--accent-dim);
    }
    .form-input:focus, .form-textarea:focus, .form-select:focus{
      outline: none;
      border-color: var(--border-input-focus);
      background: var(--bg-form);
      box-shadow: 
        inset 0 0 10px var(--accent-border),
        var(--shadow-glow);
      color: var(--text-primary);
    }
    .form-textarea{
      resize: vertical; min-height: 80px;
      line-height: 1.4;
    }
    .form-select{
      cursor: pointer;
    }
    .form-select option{
      background: #000; color: #84ffb0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .form-input::placeholder, .form-textarea::placeholder{
      color: rgba(132,255,176,0.5);
      font-style: italic;
    }
    
    /* Phone Number with Country Code Selector */
    .phone-input-container {
      display: flex;
      gap: 8px;
      position: relative;
    }
    
    .country-selector {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 10px 12px;
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      color: var(--text-muted);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: inset 0 0 10px var(--accent-dim);
      min-width: 110px;
      white-space: nowrap;
    }
    
    .country-selector:hover {
      border-color: var(--border-input-focus);
      background: var(--bg-form);
    }
    
    .country-flag {
      width: 20px;
      height: 15px;
      object-fit: cover;
      border-radius: 2px;
      flex-shrink: 0;
    }
    
    .country-code {
      color: var(--text-primary);
      font-weight: 600;
      flex: 1;
    }
    
    .dropdown-arrow {
      color: var(--text-muted);
      flex-shrink: 0;
      transition: transform 0.3s;
    }
    
    .country-selector.open .dropdown-arrow {
      transform: rotate(180deg);
    }
    
    .phone-input {
      flex: 1;
      min-width: 0;
    }
    
    .country-dropdown {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 400px;
      max-height: 80vh;
      background: var(--bg-form);
      border: 2px solid var(--border-form);
      border-radius: 12px;
      box-shadow: 
        0 30px 100px rgba(0,255,65,0.3),
        0 20px 60px rgba(0,0,0,0.9);
      z-index: 10000;
      overflow: hidden;
      animation: dropdownFadeIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .country-dropdown-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(4px);
      z-index: 9999;
      animation: backdropFadeIn 0.3s ease-out;
    }
    
    @keyframes backdropFadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    
    @keyframes dropdownFadeIn {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }
    
    .country-dropdown-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 16px 12px;
      border-bottom: 1px solid var(--border-form);
    }
    
    .country-dropdown-title {
      color: var(--text-hero);
      font-size: 16px;
      font-weight: 700;
      margin: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-shadow: var(--shadow-glow);
      letter-spacing: 0.5px;
    }
    
    .country-dropdown-close {
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      color: var(--text-hero);
      font-size: 24px;
      cursor: pointer;
      padding: 2px 8px;
      line-height: 1;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      transition: all 0.2s;
      border-radius: 4px;
    }
    
    .country-dropdown-close:hover {
      background: var(--btn-form-hover);
      box-shadow: var(--shadow-glow);
      transform: scale(1.1);
    }
    
    .country-search {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-input);
      border: none;
      border-bottom: 1px solid var(--border-form);
      color: var(--text-primary);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12px;
      outline: none;
    }
    
    .country-search::placeholder {
      color: rgba(132,255,176,0.5);
    }
    
    .country-search:focus {
      background: var(--bg-form);
      box-shadow: inset 0 0 10px var(--accent-dim);
    }
    
    .country-list {
      max-height: calc(80vh - 160px);
      overflow-y: auto;
      padding: 4px;
    }
    
    .country-list::-webkit-scrollbar {
      width: 8px;
    }
    
    .country-list::-webkit-scrollbar-track {
      background: var(--bg-input);
    }
    
    .country-list::-webkit-scrollbar-thumb {
      background: var(--accent-border);
      border-radius: 4px;
    }
    
    .country-list::-webkit-scrollbar-thumb:hover {
      background: var(--accent-secondary);
    }
    
    .country-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 10px;
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 4px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12px;
    }
    
    .country-item:hover {
      background: var(--accent-dim);
      color: var(--text-primary);
    }
    
    .country-item-flag {
      width: 24px;
      height: 18px;
      object-fit: cover;
      border-radius: 2px;
      flex-shrink: 0;
    }
    
    .country-item-name {
      flex: 1;
      color: var(--text-muted);
    }
    
    .country-item-code {
      color: var(--text-hero);
      font-weight: 600;
      margin-left: auto;
    }
    
    .country-item.selected {
      background: var(--accent-dim);
      color: var(--text-primary);
    }
    
    /* Mobile adjustments for country selector */
    @media (max-width: 768px) {
      .phone-input-container {
        flex-direction: row;
        gap: 6px;
      }
      
      .country-selector {
        min-width: 100px;
        padding: 8px 10px;
        font-size: 12px;
      }
      
      .country-flag {
        width: 18px;
        height: 13px;
      }
      
      .country-dropdown {
        max-width: 100%;
      }
    }
    
    @media (max-width: 480px) {
      .country-selector {
        min-width: 90px;
        padding: 6px 8px;
        font-size: 11px;
      }
      
      .country-flag {
        width: 16px;
        height: 12px;
      }
      
      .country-code {
        font-size: 11px;
      }
    }
    
    .form-actions{
      display: flex; gap: 12px; margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid rgba(0,255,65,0.3);
    }
    .btn-submit{
      flex: 1; min-height: 40px;
      background: var(--btn-form-bg);
      border: 1px solid var(--btn-form-border);
      color: var(--text-hero);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight: 700; font-size: 14px;
      cursor: pointer; transition: all 0.3s;
      letter-spacing: 1px;
    }
    .btn-submit:hover{
      background: var(--btn-form-hover);
      box-shadow: var(--shadow-glow);
      text-shadow: var(--shadow-glow);
    }
    .btn-submit:disabled{
      opacity: 0.5; cursor: not-allowed;
      background: var(--btn-form-bg);
      box-shadow: none; text-shadow: none;
    }
    .btn-cancel{
      padding: 10px 20px;
      background: var(--btn-form-bg);
      border: 1px solid var(--text-muted);
      color: var(--text-muted);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight: 600; cursor: pointer;
      transition: all 0.3s; font-size: 14px;
    }
    .btn-cancel:hover{
      background: var(--btn-form-hover);
      border-color: var(--text-muted);
      box-shadow: var(--shadow-glow);
    }
    
    /* Form States */
    #helpForm .form-group,
    #helpForm .form-actions {
      transition: opacity 0.3s ease-out;
    }
    
    /* Loading State */
    .loading{
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      color: var(--status-loading);
      font-size: 14px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-align: center;
      padding: 20px;
      background: rgba(0,255,65,0.05);
      border: 1px solid var(--status-loading);
      border-radius: 8px;
      width: 90%;
      max-width: 400px;
      opacity: 0;
      transition: opacity 0.3s ease-out;
    }
    .loading.show{
      display: flex;
      opacity: 1;
    }
    
    .loading-content {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .loading-content:before{
      content: "> ";
      color: var(--status-loading);
    }
    
    .spinner{
      width: 20px;
      height: 20px;
      border: 2px solid var(--accent-border);
      border-top: 2px solid var(--status-loading);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .loading-dots {
      display: inline-flex;
      gap: 4px;
    }
    .loading-dots span {
      width: 4px;
      height: 4px;
      background: var(--status-loading);
      border-radius: 50%;
      animation: loadingDots 1.4s ease-in-out infinite both;
    }
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    .loading-dots span:nth-child(3) { animation-delay: 0s; }
    
    @keyframes spin{ 0%{ transform: rotate(0deg); } 100%{ transform: rotate(360deg); } }
    @keyframes loadingDots {
      0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
      40% { transform: scale(1); opacity: 1; }
    }
    
    /* Success State */
    .success-message{
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.95);
      display: none;
      text-align: center;
      padding: 40px 20px;
      color: var(--status-success);
      font-size: 14px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      border: 2px solid var(--status-success);
      background: rgba(0,255,65,0.1);
      margin: 0;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,255,65,0.2);
      min-height: 120px;
      width: 90%;
      max-width: 400px;
      opacity: 0;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: all 0.3s ease-out;
    }
    .success-message.show{
      display: flex;
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    .success-message h3{
      margin: 0 0 16px 0;
      font-size: 20px;
      text-shadow: var(--shadow-glow);
      font-weight: 700;
    }
    .success-message h3:before{ content: "> "; }
    .success-message p{ 
      margin: 0;
      opacity: 0.9; 
      font-size: 14px;
      line-height: 1.5;
      max-width: 400px;
    }
    

    /* Pricing Section */
    .pricing-content {
      margin-top: 32px;
      opacity: 0;
      transform: translateY(30px);
      transition: all 1.0s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .about-section.expanded .pricing-content {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 1.6s;
    }
    
    .pricing-title {
      font-size: clamp(24px, 4vw, 36px);
      color: var(--text-hero);
      margin: 0 0 32px 0;
      text-align: center;
      font-weight: 800;
      text-shadow: 0 0 20px var(--accent-glow);
    }
    
    .pricing-calculator {
      background: rgba(0,255,65,0.03);
      border: 2px solid var(--border-primary);
      border-radius: 16px;
      padding: clamp(24px, 4vw, 40px);
      transition: all 0.3s ease;
    }
    
    .pricing-calculator:hover {
      border-color: var(--accent-border);
      box-shadow: 0 10px 40px var(--accent-dim);
    }
    
    .calculator-header {
      text-align: center;
      margin-bottom: 32px;
    }
    
    .calculator-header h3 {
      font-size: clamp(18px, 3vw, 24px);
      color: var(--text-primary);
      margin: 0 0 8px 0;
      font-weight: 700;
    }
    
    .calculator-header p {
      font-size: clamp(12px, 2vw, 14px);
      color: var(--text-secondary);
      margin: 0;
      opacity: 0.8;
    }
    
    .calculator-form {
      display: grid;
      gap: 20px;
      max-width: 600px;
      margin: 0 auto;
    }
    
    .calc-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .calc-row label {
      color: var(--text-primary);
      font-size: clamp(12px, 2vw, 14px);
      font-weight: 600;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .calc-select {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      border-radius: 0;
      color: var(--text-muted);
      font-size: 13px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: inset 0 0 10px var(--accent-dim);
    }
    
    .calc-select:focus {
      outline: none;
      border-color: var(--border-input-focus);
      background: var(--bg-form);
      box-shadow: 
        inset 0 0 10px var(--accent-border),
        var(--shadow-glow);
    }
    
    .calc-select option {
      background: #000;
      color: #84ffb0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .calc-result {
      margin-top: 24px;
      padding: 24px;
      background: rgba(0,255,65,0.08);
      border: 2px solid var(--accent-border);
      border-radius: 12px;
      text-align: center;
    }
    
    .result-label {
      color: var(--text-secondary);
      font-size: clamp(12px, 2vw, 14px);
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .result-price {
      color: var(--text-hero);
      font-size: clamp(36px, 8vw, 56px);
      font-weight: 900;
      font-style: italic;
      line-height: 1;
      text-shadow: 0 0 20px var(--accent-glow);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      margin-bottom: 12px;
    }
    
    .result-note {
      color: var(--text-secondary);
      font-size: clamp(10px, 1.5vw, 12px);
      opacity: 0.7;
      font-style: italic;
    }
    
    .calc-disclaimer {
      margin-top: 16px;
      text-align: center;
      color: var(--text-secondary);
      font-size: clamp(9px, 1.3vw, 10px);
      opacity: 0.6;
      font-style: italic;
      line-height: 1.4;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .result-special-notice {
      color: var(--text-hero);
      font-size: clamp(11px, 1.8vw, 13px);
      margin: 12px 0 8px 0;
      padding: 12px;
      background: rgba(0,255,65,0.15);
      border-left: 3px solid var(--accent-primary);
      border-radius: 4px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      line-height: 1.5;
    }
    
    .result-special-notice strong {
      color: var(--accent-primary);
      font-weight: 700;
    }
    
    .manual-estimate-btn {
      display: inline-block;
      margin-top: 16px;
      padding: 12px 24px;
      background: var(--accent-dim);
      border: 2px solid var(--accent-border);
      border-radius: 8px;
      color: var(--text-primary);
      font-weight: 700;
      font-size: clamp(12px, 2vw, 14px);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 15px var(--accent-dim);
    }
    
    .manual-estimate-btn:hover {
      background: var(--accent-bright);
      border-color: var(--accent-primary);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0,255,65,0.4);
    }
    
    .payment-info {
      margin-top: 40px;
      padding-top: 32px;
      border-top: 1px solid var(--border-primary);
    }
    
    .payment-info h4 {
      color: var(--text-primary);
      font-size: clamp(16px, 2.5vw, 20px);
      margin: 0 0 12px 0;
      font-weight: 700;
      text-align: center;
    }
    
    .payment-info > p {
      color: var(--text-secondary);
      font-size: clamp(12px, 2vw, 14px);
      text-align: center;
      margin: 0 0 24px 0;
    }
    
    .payment-methods {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      max-width: 600px;
      margin: 0 auto;
    }
    
    .payment-method {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: rgba(0,255,65,0.05);
      border: 2px solid var(--border-primary);
      border-radius: 12px;
      transition: all 0.3s ease;
    }
    
    .payment-method:hover {
      border-color: var(--accent-border);
      background: rgba(0,255,65,0.1);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px var(--accent-dim);
    }
    
    .payment-icon {
      color: var(--accent-primary);
      flex-shrink: 0;
    }
    
    .payment-method span {
      color: var(--text-secondary);
      font-size: clamp(12px, 2vw, 14px);
      font-weight: 600;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    @media (max-width: 768px) {
      .pricing-content {
        margin-top: 24px;
      }
      
      .payment-methods {
        grid-template-columns: 1fr;
      }
    }

    /* Footer Widget */
    .footer-widget {
      margin-top: 32px;
      padding-top: 20px;
      border-top: 1px solid var(--border-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .card.show.ready .footer-widget {
      opacity: 1;
      transform: translateY(0);
      transition-delay: 1.4s;
    }
    
    .footer-copyright {
      color: var(--text-secondary);
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.5px;
      opacity: 0.9;
    }
    
    .footer-link-btn {
      background: rgba(0,255,65,0.05);
      border: 1px solid var(--border-primary);
      color: var(--text-secondary);
      font-size: 10px;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight: 600;
      letter-spacing: 0.3px;
    }
    
    .footer-link-btn:hover {
      background: var(--accent-dim);
      border-color: var(--accent-border);
      color: var(--text-primary);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px var(--accent-dim);
    }
    
    /* Mobile adjustments for footer widget */
    @media (max-width: 768px) {
      .footer-widget {
        margin-top: 20px;
        padding-top: 16px;
        gap: 12px;
      }
      
      .footer-copyright {
        font-size: 10px;
        width: 100%;
        text-align: center;
      }
      
      .footer-link-btn {
        font-size: 9px;
        padding: 5px 10px;
      }
    }
    
    /* Policy Modal Styles */
    .policy-modal {
      position: fixed; inset: 0; z-index: 20;
      display: grid; place-items: center; padding: 20px;
      background: rgba(0,0,0,0);
      backdrop-filter: blur(0px);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  visibility 0s linear 0.5s;
    }
    
    .policy-modal.show {
      opacity: 1;
      visibility: visible;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .policy-modal .form-container {
      transform: scale(0.8) translateY(30px);
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .policy-modal.show .form-container {
      transform: scale(1) translateY(0);
      opacity: 1;
    }
    
    .policy-content {
      color: var(--text-secondary);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 13px;
      line-height: 1.6;
    }
    
    .policy-content h3 {
      color: var(--text-hero);
      font-size: 16px;
      margin: 0 0 20px 0;
      font-weight: 700;
      text-shadow: var(--shadow-glow);
    }
    
    .policy-content h4 {
      color: var(--text-primary);
      font-size: 14px;
      margin: 16px 0 8px 0;
      font-weight: 700;
    }
    
    .policy-content h4:before {
      content: "> ";
      color: var(--accent-primary);
    }
    
    .policy-content p {
      margin: 0 0 12px 0;
      color: var(--text-secondary);
    }
    
    .policy-content ul {
      list-style-type: disc;
      color: var(--text-secondary);
      margin: 8px 0 12px 20px;
      padding: 0;
    }
    
    .policy-content li {
      margin: 4px 0;
      color: var(--text-secondary);
    }
    
    .policy-content a {
      color: var(--text-hero);
      text-decoration: underline;
    }
    
    .policy-content a:hover {
      color: var(--accent-primary);
    }

    /* QR Code Button */
    .qr-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--accent-dim);
      border: 2px solid var(--accent-border);
      color: var(--text-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 100;
      box-shadow: var(--shadow-glow);
    }

    .qr-button:hover {
      transform: scale(1.1);
      background: var(--accent-bright);
      box-shadow: 0 0 20px rgba(0,255,65,0.3);
    }

    /* QR Code Modal */
    .qr-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(3px);
      display: none;
      place-items: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .qr-modal.show {
      display: grid;
      opacity: 1;
    }

    .qr-container {
      background: var(--bg-card);
      border: 2px solid var(--accent-border);
      border-radius: 12px;
      padding: 24px;
      position: relative;
      text-align: center;
      max-width: 90%;
      width: 360px;
      transform: scale(0.95);
      opacity: 0;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-glow);
    }

    .qr-modal.show .qr-container {
      transform: scale(1);
      opacity: 1;
    }

    .qr-close {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 30px;
      height: 30px;
      border: none;
      background: none;
      color: var(--text-muted);
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.3s ease;
    }

    .qr-close:hover {
      color: var(--text-primary);
    }

    .qr-container h3 {
      color: var(--text-primary);
      font-size: 20px;
      margin: 0 0 24px 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }

    .qr-container p {
      color: var(--text-muted);
      font-size: 14px;
      margin: 24px 0 0 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }

    #qrCode {
      background: #00ff4147;
      padding: 16px;
      border-radius: 8px;
      display: inline-block;
      line-height: 0;
    }

    #qrCode {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 280px;
    }

    #qrCode svg {
      max-width: 100%;
      height: auto;
    }

    /* QR Code Animation Styles */
    #qrCode svg rect,
    #qrCode svg path,
    #qrCode svg circle,
    #qrCode svg polygon {
      opacity: 0;
      /* Base fade plus optional retro blink injected via CSS var */
      animation: sectionFadeOpacity 0.5s ease-in-out forwards, var(--qr-blink-animation, none);
      will-change: opacity;
    }

    @keyframes sectionFadeOpacity {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }

    /* Retro-style quick blink for select modules */
    @keyframes dotBlink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    /* Mobile responsiveness for QR code */
    @media (max-width: 480px) {
      .qr-container {
        width: 95%;
        padding: 20px;
        max-height: 90vh;
        overflow-y: auto;
      }
      
      #qrCode {
        min-height: 240px;
      }
      
      .qr-container h3 {
        font-size: 18px;
        margin-bottom: 16px;
      }
      
      .qr-container p {
        font-size: 13px;
        margin-top: 16px;
      }
    }

    /* Improve SVG rendering quality and smoothing for QR code */
    #qrCode svg {
      shape-rendering: geometricPrecision;
      image-rendering: optimizeQuality;
      text-rendering: optimizeLegibility;
    }

    /* Ready to Work Popup */
    .ready-popup {
      position: fixed;
      inset: 0;
      z-index: 100;
      display: grid;
      place-items: center;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(4px);
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .ready-popup.show {
      opacity: 1;
      visibility: visible;
    }
    
    .ready-popup-container {
      width: min(400px, 90vw);
      background: var(--bg-form);
      border: 2px solid var(--border-form);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 
        0 30px 100px rgba(0,255,65,0.3),
        0 10px 40px rgba(0,0,0,0.8);
      position: relative;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      transform: scale(0.9) translateY(20px);
      transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .ready-popup.show .ready-popup-container {
      transform: scale(1) translateY(0);
    }
    
    .ready-popup-close {
      position: absolute;
      top: 12px;
      right: 12px;
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      color: var(--text-hero);
      font-size: 24px;
      cursor: pointer;
      padding: 2px 8px;
      line-height: 1;
      transition: all 0.2s;
      border-radius: 4px;
    }
    
    .ready-popup-close:hover {
      background: var(--btn-form-hover);
      box-shadow: var(--shadow-glow);
      transform: scale(1.1);
    }
    
    .ready-popup-title {
      color: var(--text-hero);
      font-size: clamp(18px, 3vw, 22px);
      font-weight: 800;
      margin: 0 0 12px 0;
      text-shadow: var(--shadow-glow);
      text-align: center;
    }
    
    .ready-popup-text {
      color: var(--text-secondary);
      font-size: clamp(13px, 2vw, 15px);
      line-height: 1.6;
      margin: 0 0 20px 0;
      text-align: center;
    }
    
    .ready-popup-btn {
      width: 100%;
      margin: 0;
    }
    
    /* Mobile adjustments for popup */
    @media (max-width: 768px) {
      .ready-popup-container {
        width: 95%;
        padding: 20px;
      }
    }

    /* Affiliate Modal Styles */
    .affiliate-modal {
      position: fixed; inset: 0; z-index: 20;
      display: grid; place-items: center; padding: 20px;
      background: rgba(0,0,0,0);
      backdrop-filter: blur(0px);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  visibility 0s linear 0.5s;
    }
    
    .affiliate-modal.show { 
      opacity: 1;
      visibility: visible;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
      transition: opacity 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                  background-color 0.5s cubic-bezier(0.23, 1, 0.32, 1),
                  backdrop-filter 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    }
    
    .affiliate-container {
      width: min(600px, 100%); max-height: 90vh; overflow-y: auto;
      background: var(--bg-form);
      border: 2px solid var(--border-form);
      border-radius: 12px;
      padding: clamp(16px, 3vw, 24px);
      box-shadow: 
        0 30px 100px rgba(0,255,65,0.25),
        0 10px 40px rgba(0,0,0,0.8),
        0 0 0 1px rgba(0,255,65,0.1);
      position: relative;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      opacity: 0;
      transform: scale(0.7) translateY(60px);
      transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1);
      will-change: transform, opacity;
    }
    
    .affiliate-modal.show .affiliate-container {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    
    .affiliate-header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 20px; padding-bottom: 12px;
      border-bottom: 1px solid #00ff41;
    }
    
    .affiliate-title {
      font-size: clamp(16px, 3vw, 20px);
      color: var(--text-hero); margin: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-shadow: var(--shadow-glow);
      letter-spacing: 1px;
    }
    
    .affiliate-title:before { content: "> "; }
    
    .affiliate-content {
      text-align: center;
    }
    
    .affiliate-icon {
      font-size: 48px;
      margin-bottom: 16px;
      display: block;
    }
    
    .affiliate-content h3 {
      color: var(--text-hero);
      font-size: clamp(18px, 3vw, 24px);
      margin: 0 0 16px 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-shadow: var(--shadow-glow);
    }
    
    .affiliate-content p {
      color: var(--text-secondary);
      font-size: clamp(14px, 2vw, 16px);
      line-height: 1.5;
      margin: 0 0 24px 0;
    }
    
    .affiliate-link-container {
      margin: 24px 0;
      text-align: left;
    }
    
    .link-display {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    
    .affiliate-link-text {
      flex: 1;
      background: var(--bg-input);
      border: 1px solid var(--border-form);
      color: var(--text-hero);
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      box-shadow: inset 0 0 10px var(--accent-dim);
      word-break: break-all;
      line-height: 1.4;
      min-height: 20px;
      display: flex;
      align-items: center;
    }
    
    .btn-copy {
      background: var(--btn-form-bg);
      border: 1px solid var(--btn-form-border);
      color: var(--text-hero);
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight: 700; font-size: 12px;
      cursor: pointer; transition: all 0.3s;
      padding: 8px 16px;
      white-space: nowrap;
    }
    
    .btn-copy:hover {
      background: var(--btn-form-hover);
      box-shadow: var(--shadow-glow);
    }
    
    .affiliate-terms {
      background: var(--bg-input);
      border: 1px solid var(--accent-border);
      border-radius: 8px;
      padding: 16px;
      margin: 24px 0;
      text-align: left;
    }
    
    .affiliate-terms h4 {
      color: var(--text-hero);
      font-size: 16px;
      margin: 0 0 12px 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    
    .affiliate-terms ul {
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.5;
      margin: 0;
      padding-left: 20px;
    }
    
    .affiliate-terms li {
      margin-bottom: 8px;
    }
    
    .affiliate-terms a {
      color: var(--text-hero);
      text-decoration: underline;
    }
    
    .affiliate-terms a:hover {
      color: var(--accent-primary);
    }
    
    /* Affiliate form animation states (same as client form) */
    #affiliateForm .form-group {
      transform: translateX(-40px);
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    #affiliateForm .form-group.animate-in {
      transform: translateX(0);
      opacity: 1;
    }
    
    #affiliateForm .form-label {
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.4s ease-out;
    }
    
    #affiliateForm .form-label.animate-in {
      opacity: 1;
      transform: translateX(0);
    }
    
    #affiliateForm .form-input {
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    #affiliateForm .form-input.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    /* Mobile Responsive Form */
    @media (max-width: 768px){
      #formModal{ padding: 12px; }
      .form-container{
        width: 100%; max-height: 95vh;
        padding: 16px;
        font-size: 12px;
      }
      .form-title{ font-size: 16px; }
      .form-label{ font-size: 12px; }
      .form-input, .form-textarea, .form-select{
        font-size: 12px; padding: 8px 10px;
      }
      .form-textarea{ min-height: 60px; }
      .form-actions{ 
        flex-direction: column; gap: 8px;
        margin-top: 16px; padding-top: 12px;
      }
      .btn-submit, .btn-cancel{
        width: 100%; min-height: 44px;
        font-size: 13px;
      }
      .form-group{ margin-bottom: 12px; }
      
      /* Affiliate Modal Mobile */
      .affiliate-modal { padding: 12px; }
      .affiliate-container {
        width: 100%; max-height: 95vh;
        padding: 16px;
        font-size: 12px;
      }
      .affiliate-title { font-size: 16px; }
      .affiliate-content h3 { font-size: 18px; }
      .affiliate-content p { font-size: 14px; }
      .link-display { flex-direction: column; }
      .btn-copy { width: 100%; }
    }

    @media (max-width: 480px){
      .form-container{
        padding: 12px; font-size: 11px;
        border-width: 1px;
      }
      .form-title{ font-size: 14px; }
      .form-label{ font-size: 11px; }
      .form-input, .form-textarea, .form-select{
        font-size: 11px; padding: 6px 8px;
      }
      .close-btn{ font-size: 14px; padding: 2px 6px; }
      .btn-submit, .btn-cancel{ min-height: 40px; }
    }

    @media (prefers-reduced-motion: reduce){
      .bar, .card, .form-container, .form-group{ 
        animation: none !important; 
        transition: none !important;
      }
      #boot{ transition: none !important; }
    }
  </style>
</head>
<body>
  <canvas id="matrixCanvas"></canvas>

  <!-- Boot overlay -->
  <div id="boot" aria-live="polite">
      <div class="boot-card" role="status" aria-label="Boot sequence">
        <div id="terminal" class="terminal"></div>
        <div class="hero-text">DOES YOUR BUSINESS NEED TECHNICAL EXPERTISE?</div>
        <div class="boot-controls">
          <span class="tip" aria-hidden="true">Tip: press "Skip" to jump ahead.</span>
          <button id="skipBtn" class="btn-skip" type="button">Skip</button>
        </div>
      </div>
  </div>

  <!-- Static label -->
  <div class="badge" aria-hidden="true">
    <div class="label">Charlie Russo</div>
    <div class="bar"></div>
  </div>

  <!-- CTA -->
  <main class="wrap">
    <section id="card" class="card" role="region" aria-label="Technical help call to action">
      <div class="card-content">
        <div class="hero-text">
          <span class="typing-text">
            <span class="line1"></span>
            <span class="line2"></span>
            <span class="line3"></span>
          </span>
        </div>
        <p class="tagline">
          <span class="tagline-line1">Affordable development freelancing services for</span>
          <span class="tagline-line2">fullstack development, prototype manufacturing, etc.</span>
        </p>
        <div class="actions">
          <button class="btn" id="openFormBtn" type="button">Fill out Your Inquiry Here</button>
          <button class="btn btn-affiliate" id="openAffiliateBtn" type="button">Become an Affiliate</button>
          <a class="email" href="mailto:russoc2023@fau.edu" aria-label="Email russoc2023 at fau dot edu">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z" stroke="currentColor" stroke-width="1.6"/>
              <path d="m4 7 8 6 8-6" stroke="currentColor" stroke-width="1.6"/>
            </svg>
            russoc2023@fau.edu
          </a>
        </div>
        
        <!-- About Section -->
        <div class="about-section expanded" id="aboutSection">
          <div class="about-divider"></div>
          <h2 class="about-title">About</h2>
          <div class="about-content">
            <div class="about-image-section">
              <div class="about-image">
                <img src="media/charlie.jpg" alt="Charles Russo" />
              </div>
              <a href="https://www.linkedin.com/in/charles-russo-b5bb20338/" target="_blank" rel="noopener noreferrer" class="linkedin-btn">
                <svg class="linkedin-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
                Connect on LinkedIn
              </a>
            </div>
            <div class="about-text">
              <p>This is a technical consulting service led by Charles Russo, a prospective University of Chicago student with years of experience in engineering and technology. Charles has worked on a wide range of projects, combining innovation with practical expertise.</p>
              <p>We specialize in full-stack software development, hardware development, and a variety of other technical solutions designed to bring your ideas to life. Whether you're building a product from the ground up or need expert guidance on complex systems, we're here to help.</p>
            </div>
          </div>
          
          <!-- Trusted By Section -->
          <div class="trusted-by-section">
            <h3 class="trusted-by-title">Trusted by:</h3>
            <div class="clients-logos">
              <a href="https://coolshield.net/" target="_blank" rel="noopener noreferrer" class="client-logo-link">
                <img src="media/clients/coolshield.png" alt="Cool Shield Insulation" class="client-logo">
              </a>
              <a href="https://axa-fau.org/" target="_blank" rel="noopener noreferrer" class="client-logo-link">
                <img src="media/clients/axa.png" alt="AXA - Aerospace Experimental Association" class="client-logo">
              </a>
              <a href="https://ecoengine.net/index.html" target="_blank" rel="noopener noreferrer" class="client-logo-link">
                <img src="media/clients/mallard.png" alt="Mallard Motorsports" class="client-logo">
              </a>
            </div>
          </div>
          
          <!-- Stats Section -->
          <div class="about-stats">
            <div class="stat-card">
              <div class="stat-label">Up to</div>
              <div class="stat-number">95%</div>
              <div class="stat-description">Saving on Website Costs</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">We have</div>
              <div class="stat-number">ZERO</div>
              <div class="stat-description">Recurring or Hidden Fees</div>
            </div>
          </div>
          
          <!-- Bottom Divider -->
          <div class="about-divider about-divider-bottom"></div>
          
          <!-- Pricing Section -->
          <div class="pricing-content">
            <h2 class="pricing-title">Pricing and Payment</h2>
            
            <div class="pricing-calculator">
              <div class="calculator-header">
                <h3>Project Cost Estimator</h3>
                <p>Select your project requirements to get an estimated cost</p>
              </div>
              
              <div class="calculator-form">
                <div class="calc-row">
                  <label for="calcProjectType">Project Type</label>
                  <select id="calcProjectType" class="calc-select">
                    <option value="">Select project type...</option>
                    <option value="200">Website Design (Basic)</option>
                    <option value="700">Website Design (Advanced)</option>
                    <option value="2000">Full-Stack Web Application</option>
                    <option value="3000">Mobile App Development</option>
                    <option value="1000">Hardware Prototyping</option>
                    <option value="700">Simple CAD Design</option>
                    <option value="100">Hourly Technical Consulting</option>
                    <option value="500">Code Review & Optimization</option>
                    <option value="300">Logo Design</option>
                    <option value="400">Graphic Design for Clothes</option>
                    <option value="250">Custom Social Media / Email Templates</option>
                    <option value="800">2D Animation</option>
                    <option value="1500">3D Animation</option>
                  </select>
                </div>
                
                <div class="calc-row">
                  <label for="calcComplexity">Project Complexity</label>
                  <select id="calcComplexity" class="calc-select">
                    <option value="">Select complexity...</option>
                    <option value="1">Simple</option>
                    <option value="1.7">Moderate</option>
                    <option value="2">Complex</option>
                    <option value="4">Enterprise-Level</option>
                  </select>
                </div>
                
                <div class="calc-row">
                  <label for="calcTimeline">Timeline</label>
                  <select id="calcTimeline" class="calc-select">
                    <option value="">Select timeline...</option>
                    <option value="0.9">Flexible (2+ weeks)</option>
                    <option value="1">Standard (1-2 weeks)</option>
                    <option value="1.3">Rush (1 week)</option>
                    <option value="2">Urgent (72 Hours)</option>
                  </select>
                </div>
                
                <div class="calc-row">
                  <label for="calcSupport">Post-Launch Support</label>
                  <select id="calcSupport" class="calc-select">
                    <option value="">Select support...</option>
                    <option value="1">None</option>
                    <option value="1.2">1 Month</option>
                    <option value="1.3">3 Months</option>
                    <option value="1.5">6 Months</option>
                    <option value="3">12 Months</option>
                  </select>
                </div>
                
                <div class="calc-result">
                  <div class="result-label">Estimated Cost:</div>
                  <div class="result-price" id="calcResult">$0</div>
                  <button class="manual-estimate-btn" id="manualEstimateBtn" type="button">Click Here for Your Inquiry</button>
                  <div class="result-special-notice" id="complexProjectNotice" style="display: none;">
                    <strong>Note:</strong> This type of project's pricing is highly dependent on what you require and may deviate greatly from this estimate.
                  </div>
                </div>
                
                <div class="calc-disclaimer">*This is an estimate. Final pricing will be discussed and agreed upon before work begins. Short time frames are not applicable to all projects.</div>
              </div>
              
              <div class="payment-info">
                <h4>Payment Methods</h4>
                <p>We accept the following payment methods:</p>
                <div class="payment-methods">
                  <div class="payment-method">
                    <svg class="payment-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                      <line x1="1" y1="10" x2="23" y2="10"></line>
                    </svg>
                    <span>Credit/Debit Cards via PayPal</span>
                  </div>
                  <div class="payment-method">
                    <svg class="payment-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <line x1="12" y1="1" x2="12" y2="23"></line>
                      <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                    <span>Cash</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Footer Widget -->
      <div class="footer-widget">
        <span class="footer-copyright">© Charles Russo</span>
        <button class="footer-link-btn" id="privacyBtn" type="button">Privacy Policy</button>
        <button class="footer-link-btn" id="termsBtn" type="button">Terms of Service</button>
      </div>
    </section>
  </main>

  <!-- Privacy Policy Modal -->
  <div id="privacyModal" class="policy-modal" aria-hidden="true">
    <div class="form-container" role="dialog" aria-labelledby="privacyTitle">
      <div class="form-header">
        <h2 id="privacyTitle" class="form-title">Privacy Policy</h2>
        <button class="close-btn" id="closePrivacyBtn" type="button" aria-label="Close privacy policy">&times;</button>
      </div>
      <div class="policy-content">
        <p style="margin-bottom: 20px; opacity: 0.8;">Effective Date: October 2025</p>
        
        <h4>1. Introduction</h4>
        <p>Charles Russo ("we," "us," "our") provides freelance technical consulting, software development, hardware development, and creative services. This Privacy Policy explains how we collect, use, and protect your personal information.</p>
        
        <h4>2. Information We Collect</h4>
        <p>We may collect the following information when you contact or work with us:</p>
        <ul style="margin-left: 20px; margin-bottom: 12px;">
          <li>Name, email address, and phone number</li>
          <li>Company name, website, and project details</li>
          <li>Billing information (if applicable)</li>
        </ul>
        
        <h4>3. How We Use Your Information</h4>
        <p>We use your information to:</p>
        <ul style="margin-left: 20px; margin-bottom: 12px;">
          <li>Communicate with you about your project</li>
          <li>Provide and improve our services</li>
          <li>Send invoices and payment reminders</li>
          <li>With your consent, send marketing messages or updates about our work</li>
        </ul>
        <p>We will not sell or share your personal data with third parties for unrelated marketing purposes.</p>
        
        <h4>4. Marketing Communications</h4>
        <p>We only send marketing or promotional messages if you explicitly consent (for example, by checking a box or signing up). You can withdraw your consent anytime by replying "unsubscribe" or emailing us at <a href="mailto:russoc2023@fau.edu">russoc2023@fau.edu</a>.</p>
        
        <h4>5. Portfolio & Logo Use</h4>
        <p>We may display your logo, website screenshots, or testimonials on our website or social media to showcase completed work. We will never modify your logo or display confidential information without your approval.</p>
        
        <h4>6. Data Retention</h4>
        <p>We retain client contact information only as long as necessary to provide services or comply with legal obligations. You can request deletion at any time.</p>
        
        <h4>7. Security</h4>
        <p>We take reasonable steps to protect your data using secure storage and encrypted communications.</p>
        
        <h4>8. Your Rights (for EU/California clients)</h4>
        <p>You may request access, correction, deletion, or restriction of your data. If you are an EU or California resident, you also have the right to complain to your local data authority.</p>
        
        <h4>9. Contact</h4>
        <p>For any privacy concerns, email <a href="mailto:russoc2023@fau.edu">russoc2023@fau.edu</a>.</p>
      </div>
    </div>
  </div>

  <!-- Terms of Service Modal -->
  <div id="termsModal" class="policy-modal" aria-hidden="true">
    <div class="form-container" role="dialog" aria-labelledby="termsTitle">
      <div class="form-header">
        <h2 id="termsTitle" class="form-title">Terms of Service</h2>
        <button class="close-btn" id="closeTermsBtn" type="button" aria-label="Close terms of service">&times;</button>
      </div>
      <div class="policy-content">
        <p style="margin-bottom: 20px; opacity: 0.8;">Effective Date: October 2025</p>
        
        <h4>1. Services</h4>
        <p>Charles Russo ("Freelancer") provides freelance technical consulting, software development, hardware development, and creative services according to the agreed project scope.</p>
        
        <h4>2. Client Responsibilities</h4>
        <p>Clients must provide accurate information, materials, and approvals in a timely manner.</p>
        
        <h4>3. Intellectual Property</h4>
        <ul style="margin-left: 20px; margin-bottom: 12px;">
          <li>The client retains ownership of their logo, content, and branding materials.</li>
          <li>Freelancer may not use client materials for other purposes without consent.</li>
        </ul>
        
        <h4>4. Restrictions</h4>
        <p>Freelancer will not create, promote, or assist in the development of materials related to weapons, violence, terrorism, hate speech, or illegal activities.</p>
        
        <h4>5. Payment</h4>
        <p>Invoices are due as stated in the project agreement. Work may pause if payment is delayed.</p>
        
        <h4>6. Limitation of Liability</h4>
        <p>Freelancer provides services using reasonable skill and care but makes no guarantee of error-free or uninterrupted results. To the fullest extent permitted by law:</p>
        <ul style="margin-left: 20px; margin-bottom: 12px;">
          <li>Freelancer's total liability for any claim is limited to the total amount paid by the client for that specific project.</li>
          <li>Freelancer is not liable for indirect, incidental, or consequential damages.</li>
        </ul>
        
        <h4>7. Warranties & Disclaimers</h4>
        <p>Freelancer will correct material defects reported within 150 days of project delivery but cannot guarantee compatibility with all devices, browsers, or third-party systems.</p>
        
        <h4>8. Termination</h4>
        <p>Either party may terminate the agreement with written notice if the other breaches material terms. Outstanding payments remain due.</p>
        
        <h4>9. Governing Law & Dispute Resolution</h4>
        <p>This agreement is governed by the laws of the State of Florida, United States.</p>
        <p><strong>Arbitration:</strong> Any disputes, claims, or controversies arising from or relating to this agreement shall be resolved through binding arbitration rather than in court. Arbitration will be conducted by a single arbitrator in accordance with the rules of the American Arbitration Association (AAA). The arbitration will take place in Florida, and the arbitrator's decision will be final and binding on both parties.</p>
        <p>Both parties waive the right to a jury trial and the right to participate in a class action. The prevailing party in any arbitration shall be entitled to recover reasonable attorney's fees and costs.</p>
        
        <h4>10. Affiliate Program</h4>
        <p>Affiliates receive commission for successful referrals as agreed upon. For affiliate inquiries, email <a href="mailto:russoc2023@fau.edu">russoc2023@fau.edu</a>.</p>
        
        <h4>11. Acceptance</h4>
        <p>By hiring Charles Russo or using the services, the client agrees to these Terms of Service and the accompanying Privacy Policy.</p>
        
        <h4>Contact</h4>
        <p>For questions, email <a href="mailto:russoc2023@fau.edu">russoc2023@fau.edu</a></p>
      </div>
    </div>
  </div>

  <!-- Form Modal -->
  <div id="formModal" aria-hidden="true">
    <div class="form-container" role="dialog" aria-labelledby="formTitle">
      <div class="form-header">
        <h2 id="formTitle" class="form-title">Technical Help Request</h2>
        <button class="close-btn" id="closeFormBtn" type="button" aria-label="Close form">&times;</button>
      </div>
      
      <form id="helpForm">
        <div class="form-group">
          <label class="form-label" for="name">Full Name *</label>
          <input type="text" id="name" name="name" class="form-input" required>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="email">Email Address *</label>
          <input type="email" id="email" name="email" class="form-input" required>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="phone">Phone Number *</label>
          <div class="phone-input-container">
            <button type="button" class="country-selector" id="countrySelector" aria-label="Select country code">
              <img src="media/flags/us.svg" alt="US Flag" class="country-flag" id="selectedFlag">
              <span class="country-code" id="selectedCode">+1</span>
              <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <input type="tel" id="phone" name="phone" class="form-input phone-input" placeholder="(555)-555-5555" required minlength="1" title="Please enter a phone number">
            <input type="hidden" id="phoneCountryCode" name="phoneCountryCode" value="+1">
          </div>
        </div>
        
        <!-- Country Dropdown Backdrop (outside form-group) -->
        <div class="country-dropdown-backdrop" id="countryDropdownBackdrop" style="display: none;"></div>
        <div class="country-dropdown" id="countryDropdown" style="display: none;">
          <div class="country-dropdown-header">
            <h3 class="country-dropdown-title">Select Country Code</h3>
            <button type="button" class="country-dropdown-close" id="closeCountryDropdown" aria-label="Close country selector">×</button>
          </div>
          <input type="text" class="country-search" id="countrySearch" placeholder="Search countries...">
          <div class="country-list" id="countryList">
            <!-- Countries will be populated by JavaScript -->
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="urgency">Project Budget *</label>
          <select id="urgency" name="urgency" class="form-select" required>
            <option value="">Select Budget</option>
            <option value="medium">100-500 USD</option>
            <option value="high">500-1000 USD</option>
            <option value="very-high">1000-2000 USD</option>
            <option value="critical">2000+</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="category">Issue Category *</label>
          <select id="category" name="category" class="form-select" required>
            <option value="">Select category</option>
            <option value="web">Website Development</option>
            <option value="software">Backened Development</option>
            <option value="3d">3D-Printing / 3D-Modeling</option>
            <option value="electronics">Electronics Prototyping</option>
            <option value="training">Software Training</option>
            <option value="logo">Logo Design</option>
            <option value="graphic">Graphic Design for Clothes</option>
            <option value="templates">Custom Social Media / Email Templates</option>
            <option value="2d-animation">2D Animation</option>
            <option value="3d-animation">3D Animation</option>
            <option value="other">Other</option>
          </select>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="description">What do you want developed? *</label>
          <textarea id="description" name="description" class="form-textarea" 
                    placeholder="PLEASE DESCRIBE WHAT YOU NEED DEVELOPED WITH IMMENSE DETAILS."
                    required></textarea>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="device">Your Website (if it exists)</label>
          <input type="text" id="device" name="device" class="form-input" 
                 placeholder="domain.com">
        </div>
        
        <div class="loading" id="loadingState">
          <div class="loading-content">
            <div class="spinner"></div>
            <span>Sending your request</span>
            <div class="loading-dots">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
          <div style="font-size: 12px; opacity: 0.8; margin-top: 8px;">
            Processing your inquiry and sending notifications
          </div>
        </div>
        
        <div class="success-message" id="successMessage">
          <h3>✅ Your inquiry has been sent out!</h3>
          <p>Check your email for extra information. I'll get back to you as soon as possible.</p>
          <button type="button" class="btn-cancel" id="successCloseBtn" style="margin-top: 20px; font-size: 12px; padding: 8px 16px;">Close</button>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn-cancel" id="cancelBtn">Cancel</button>
          <button type="submit" class="btn-submit" id="submitBtn">Send Request</button>
        </div>
      </form>
    </div>
  </div>

  <!-- QR Code Button -->
  <button id="qrButton" class="qr-button" aria-label="Show QR Code">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="3" y="3" width="7" height="7"></rect>
      <rect x="14" y="3" width="7" height="7"></rect>
      <rect x="14" y="14" width="7" height="7"></rect>
      <rect x="3" y="14" width="7" height="7"></rect>
    </svg>
  </button>

  <!-- QR Code Modal -->
  <div id="qrModal" class="qr-modal" aria-hidden="true">
    <div class="qr-container">
      <button type="button" class="qr-close" id="closeQrBtn" aria-label="Close QR Code">×</button>
      <h3>Scan to Visit</h3>
      <div id="qrCode">
        <!-- Dynamic QR code will be generated here -->
      </div>
      <p id="qrDescription">Scan this QR code with your phone's camera to visit this website</p>
    </div>
  </div>

  <!-- Ready to Work Popup -->
  <div id="readyToWorkPopup" class="ready-popup" aria-hidden="true">
    <div class="ready-popup-container">
      <button class="ready-popup-close" id="closeReadyPopup" type="button" aria-label="Close popup">×</button>
      <h3 class="ready-popup-title">Ready to Work With Us?</h3>
      <p class="ready-popup-text">Let's bring your technical ideas to life. Fill out an inquiry and we'll get back to you soon.</p>
      <button class="btn ready-popup-btn" id="readyPopupFormBtn" type="button">Fill Out Your Inquiry Here</button>
    </div>
  </div>

  <!-- Affiliate Modal -->
  <div id="affiliateModal" class="affiliate-modal" aria-hidden="true">
    <div class="affiliate-container" role="dialog" aria-labelledby="affiliateTitle">
      <div class="affiliate-header">
        <h2 id="affiliateTitle" class="affiliate-title">Become an Affiliate</h2>
        <button class="close-btn" id="closeAffiliateBtn" type="button" aria-label="Close affiliate form">&times;</button>
      </div>
      
      <!-- Step 1: Email Input -->
      <div class="affiliate-step" id="affiliateStep1">
        <div class="affiliate-content">
          <div class="affiliate-icon">💰</div>
          <h3>Get Rewarded for Referrals!</h3>
          <p>Would you like to get rewarded for referring people to our technical services? Type your email below to get your personalized affiliate link.</p>
          
          <form id="affiliateForm">
            <div class="form-group">
              <label class="form-label" for="affiliateEmail">Your Email Address *</label>
              <input type="email" id="affiliateEmail" name="affiliateEmail" class="form-input" 
                     placeholder="your.email@example.com" required>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn-cancel" id="cancelAffiliateBtn">Cancel</button>
              <button type="submit" class="btn-submit" id="generateLinkBtn">Generate My Link</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- Step 2: Success with Link -->
      <div class="affiliate-step" id="affiliateStep2" style="display: none;">
        <div class="affiliate-content">
          <div class="affiliate-icon">🎉</div>
          <h3>Welcome to the Affiliate Program!</h3>
          <p>Thank you for becoming an affiliate of Charlie Russo Technical Services. When you send the link below to someone who requires technical freelancing, you will get an email when they submit an inquiry.</p>
          
          <div class="affiliate-link-container">
            <label class="form-label">Your Affiliate Link:</label>
            <div class="link-display">
              <div id="generatedLink" class="affiliate-link-text"></div>
            </div>
          </div>
          
          <div class="affiliate-terms">
            <h4>What happens next?</h4>
            <ul>
              <li>We'll keep you updated on whether they follow through with the process</li>
              <li>You will receive a percentage of our profit</li>
              <li>The QR button in the bottom right corner will adapt to your link and you can share this QR when using your affiliate link.</li>
              <li>To negotiate this amount, please email <a href="mailto:russoc2023@fau.edu">russoc2023@fau.edu</a></li>
            </ul>
          </div>
          
          <div class="form-actions">
            <button type="button" class="btn-cancel" id="closeAffiliateSuccessBtn">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Utilities =====
    const $ = (sel) => document.querySelector(sel);

    // ===== Matrix Canvas =====
    (function matrix() {
      const canvas = document.getElementById("matrixCanvas");
      const ctx = canvas.getContext("2d");
      const FONT_FAMILY = "ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace";
      const BASE_FONT_SIZE = 18;
      const TRAIL_FADE = 0.04;
      const CHARS = ("アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン" +
                      "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@$%#*-+=<>" +
                      "abcdefghijklmnopqrstuvwxyz").split("");

      let width=0, height=0, dpr=1, fontSize=BASE_FONT_SIZE, columns=0, drops=[];
      function resize(){
        dpr = window.devicePixelRatio || 1;
        width = canvas.clientWidth = window.innerWidth;
        height = canvas.clientHeight = window.innerHeight;
        canvas.width = Math.floor(width * dpr);
        canvas.height = Math.floor(height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
        fontSize = Math.max(14, Math.min(BASE_FONT_SIZE, Math.floor(width / 40)));
        ctx.font = fontSize + "px " + FONT_FAMILY;
        columns = Math.max(1, Math.floor(width / fontSize));
        drops = new Array(columns).fill(1 + Math.floor(Math.random() * 50));
      }
      function frame(){
        ctx.fillStyle = "rgba(0,0,0,"+TRAIL_FADE+")";
        ctx.fillRect(0,0,width,height);
        ctx.fillStyle = "#00ff4a";
        ctx.textBaseline = "top";
        for(let i=0;i<columns;i++){
          const char = CHARS[(Math.random()*CHARS.length)|0];
          const x = i * fontSize;
          const y = drops[i] * fontSize;
          ctx.fillText(char, x, y);
          if (y > height && Math.random() > 0.992) drops[i] = 0;
          drops[i]++;
        }
        requestAnimationFrame(frame);
      }
      resize();
      ctx.fillStyle = "#000"; ctx.fillRect(0,0,width,height);
      requestAnimationFrame(frame);
      window.addEventListener("resize", () => { resize(); ctx.clearRect(0,0,width,height); });
    })();

    // ===== Boot Typewriter (~1 second total) =====
    (function boot() {
      const lines = [
        "INIT SYS: waking matrix renderer…",
        "GPU: context ok  ✅  DPR=" + (window.devicePixelRatio || 1),
        "SEED: entropy ready",
        "NET: establishing secure link ▒▒▒▒▒▒▒▒▒ 100%",
        "STATUS: online",
        "> launch help()",
        "help(): Do you need technical help? — i dont think anyone is reading this lol",
      ];
      const term = $("#terminal");
      const skipBtn = $("#skipBtn");
      const boot = $("#boot");
      const card = $("#card");

      // Build containers per line
      term.innerHTML = lines.map(() => '<div class="ln"></div>').join("");
      const nodes = [...term.querySelectorAll(".ln")];

      // Compute total chars to finish in ~600ms
      const totalDuration = 600;
      const totalChars = lines.reduce((s,l)=>s+l.length,0);
      const step = Math.max(1, Math.floor(totalDuration / totalChars));

      let li=0, ci=0, done=false;
      function type(){
        if(done) return;
        const line = lines[li] || "";
        nodes[li].textContent = (li === lines.length-1 ? "> " : "> ") + line.slice(0, ci+1);
        // Add blinking cursor to current line
        nodes.forEach((n,i)=>{
          n.innerHTML = (i===li)
            ? n.textContent + '<span class="cursor">█</span>'
            : n.textContent;
        });

        ci++;
        if(ci < line.length){
          setTimeout(type, step);
        } else {
          li++; ci=0;
          if(li < lines.length){
            setTimeout(type, step);
          } else {
            // Completed: fade out boot, reveal card
            done = true;
            setTimeout(() => finish(), 200);
          }
        }
      }

      function finish(){
        const bootCard = $('.boot-card');
        const terminal = $('.terminal');
        const bootControls = $('.boot-controls');

        // Immediately hide boot controls
        bootControls.style.display = 'none';
        const typingText = $('.typing-text');
        const line1 = $('.line1');
        const line2 = $('.line2');
        const line3 = $('.line3');
        
        // Create morphing timeline with spring-like easing
        const morphTimeline = anime.timeline({
          easing: 'cubicBezier(0.22, 1, 0.36, 1)'
        });

        // Add animations to timeline
        morphTimeline
          // Fade out background
          .add({
            targets: boot,
            background: ['rgba(0,0,0,0.8)', 'rgba(0,0,0,0)'],
            backdropFilter: ['blur(4px)', 'blur(0px)'],
            duration: 600
          }, 0)
          // Fade out terminal text
          .add({
            targets: terminal,
            opacity: [1, 0],
            scale: [1, 0.9],
            translateY: [0, -10],
            duration: 300,
            easing: 'easeOutQuad'
          }, 0)
          // Morph the card
          .add({
            targets: bootCard,
            background: ['rgba(0,0,0,0.6)', 'rgba(0,0,0,0.72)'],
            borderColor: ['rgba(0,255,65,0.25)', 'rgba(0,255,65,0.18)'],
            boxShadow: [
              '0 20px 70px rgba(0,255,65,0.18)',
              '0 20px 70px rgba(0,255,65,0.28)'
            ],
            translateY: [0, 30],
            scale: {
              value: [1, 1.02, 1],
              duration: 1000,
              easing: 'cubicBezier(0.34, 1.56, 0.64, 1)'
            },
            complete: () => {
              // Hide boot overlay and show main card
              boot.style.display = 'none';
              card.classList.add('show');
              
              // Start typing animation
              typingText.style.opacity = '1';
              
              // Animate each line with typing effect (2x faster, smoother)
              const lines = ['DOES YOUR', 'BUSINESS NEED', 'TECHNICAL EXPERTISE?'];
              const lineElements = [line1, line2, line3];
              
              let currentLine = 0;
              let currentChar = 0;
              
              function typeNextChar() {
                if (currentLine < lines.length) {
                  const line = lines[currentLine];
                  const element = lineElements[currentLine];
                  
                  if (currentChar < line.length) {
                    element.textContent = line.slice(0, currentChar + 1);
                    currentChar++;
                    setTimeout(typeNextChar, 25); // Much faster, smoother typing
                  } else {
                    // Move to next line
                    currentLine++;
                    currentChar = 0;
                    setTimeout(typeNextChar, 50); // Shorter pause between lines
                  }
                } else {
                  // Typing animation complete - fade in the rest of the content
                  setTimeout(() => {
                    card.classList.add('ready');
                  }, 300); // Small delay after typing completes
                }
              }
              
              // Start typing animation immediately
              setTimeout(typeNextChar, 100);
            }
          }, 150);
      }

      skipBtn.addEventListener("click", () => { 
        done = true; 
        finish(); 
        // If skipping, immediately show all content after boot animation
        setTimeout(() => {
          card.classList.add('ready');
          // Also complete the typing text instantly
          const typingText = $('.typing-text');
          const line1 = $('.line1');
          const line2 = $('.line2');
          const line3 = $('.line3');
          if (typingText && line1 && line2 && line3) {
            typingText.style.opacity = '1';
            line1.textContent = 'DOES YOUR';
            line2.textContent = 'BUSINESS NEED';
            line3.textContent = 'TECHNICAL EXPERTISE?';
          }
        }, 800); // Wait for boot animation to complete
      });
      setTimeout(type, 50);
    })();

    // ===== Pricing Calculator =====
    (function pricingCalculator() {
      const projectTypeSelect = $('#calcProjectType');
      const complexitySelect = $('#calcComplexity');
      const timelineSelect = $('#calcTimeline');
      const supportSelect = $('#calcSupport');
      const resultElement = $('#calcResult');
      const complexProjectNotice = $('#complexProjectNotice');
      const manualEstimateBtn = $('#manualEstimateBtn');
      const openFormBtn = $('#openFormBtn');
      
      if (!projectTypeSelect || !resultElement) return;
      
      // Manual estimate button click handler
      if (manualEstimateBtn && openFormBtn) {
        manualEstimateBtn.addEventListener('click', () => {
          // Mark form as opened to prevent popup
          if (typeof window.markFormAsOpened === 'function') {
            window.markFormAsOpened();
          }
          openFormBtn.click();
        });
      }
      
      function calculatePrice() {
        const projectTypeValue = projectTypeSelect.value;
        const complexityValue = complexitySelect.value;
        const timelineValue = timelineSelect.value;
        const supportValue = supportSelect.value;
        
        // If no project type selected, show $0 and hide notice
        if (!projectTypeValue || projectTypeValue === '0') {
          animatePrice(0);
          resultElement.style.fontSize = 'clamp(36px, 8vw, 56px)';
          if (complexProjectNotice) {
            complexProjectNotice.style.display = 'none';
          }
          return;
        }
        
        // Show/hide notice for Full-Stack (2000) or Mobile App (3000) projects
        if (complexProjectNotice) {
          if (projectTypeValue === '2000' || projectTypeValue === '3000') {
            complexProjectNotice.style.display = 'block';
          } else {
            complexProjectNotice.style.display = 'none';
          }
        }
        
        let basePrice = parseFloat(projectTypeValue);
        const complexityMultiplier = parseFloat(complexityValue) || 1;
        const timelineMultiplier = parseFloat(timelineValue) || 1;
        const supportMultiplier = parseFloat(supportValue) || 1;
        
        // Calculate price progressively:
        // Start with base price, multiply by selected multipliers
        let finalPrice = basePrice;
        
        // Apply complexity if selected (not empty string)
        if (complexityValue && complexityValue !== '0') {
          finalPrice *= complexityMultiplier;
        }
        
        // Apply timeline if selected (not empty string)
        if (timelineValue && timelineValue !== '0') {
          finalPrice *= timelineMultiplier;
        }
        
        // Apply support multiplier if selected (not empty string)
        if (supportValue && supportValue !== '0') {
          finalPrice *= supportMultiplier;
        }
        
        // Round up to nearest 10
        finalPrice = Math.ceil(finalPrice / 10) * 10;
        
        // Check if price exceeds an amount
        if (finalPrice > 20000) {
          // Show "Manual Estimate Required"
          resultElement.textContent = 'Manual Estimate Required';
          resultElement.style.fontSize = 'clamp(24px, 6vw, 36px)';
        } else {
          // Show normal price
          resultElement.style.fontSize = 'clamp(36px, 8vw, 56px)';
          // Animate the price update
          animatePrice(finalPrice);
        }
      }
      
      function animatePrice(targetPrice) {
        const currentPrice = parseInt(resultElement.textContent.replace(/[$,]/g, '')) || 0;
        const duration = 800; // Animation duration in ms
        const steps = 30;
        const increment = (targetPrice - currentPrice) / steps;
        let currentStep = 0;
        
        const timer = setInterval(() => {
          currentStep++;
          const newPrice = Math.round(currentPrice + (increment * currentStep));
          resultElement.textContent = '$' + newPrice.toLocaleString();
          
          if (currentStep >= steps) {
            clearInterval(timer);
            resultElement.textContent = '$' + targetPrice.toLocaleString();
          }
        }, duration / steps);
      }
      
      // Add event listeners to all dropdowns
      projectTypeSelect.addEventListener('change', calculatePrice);
      complexitySelect.addEventListener('change', calculatePrice);
      timelineSelect.addEventListener('change', calculatePrice);
      supportSelect.addEventListener('change', calculatePrice);
      
      // Initial calculation
      calculatePrice();
    })();

    // ===== 3D Image Pan Effect =====
    (function imagePanEffect() {
      const aboutImage = $('.about-image img');
      
      if (!aboutImage) return;
      
      aboutImage.addEventListener('mousemove', (e) => {
        const rect = aboutImage.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        
        // Calculate rotation angles (max 15 degrees in each direction)
        const rotateY = ((x - centerX) / centerX) * 15;
        const rotateX = ((centerY - y) / centerY) * 15;
        
        // Apply transform
        aboutImage.style.transform = `
          perspective(1000px)
          rotateX(${rotateX}deg)
          rotateY(${rotateY}deg)
          scale3d(1.05, 1.05, 1.05)
        `;
      });
      
      aboutImage.addEventListener('mouseleave', () => {
        // Reset to original position
        aboutImage.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)';
      });
    })();

    // ===== Footer Widget & Policy Modals =====
    (function footerHandler() {
      const privacyBtn = $('#privacyBtn');
      const termsBtn = $('#termsBtn');
      const privacyModal = $('#privacyModal');
      const termsModal = $('#termsModal');
      const closePrivacyBtn = $('#closePrivacyBtn');
      const closeTermsBtn = $('#closeTermsBtn');
      
      // Open Privacy Policy Modal
      if (privacyBtn && privacyModal) {
        privacyBtn.addEventListener('click', () => {
          document.body.style.overflow = 'hidden';
          privacyModal.setAttribute('aria-hidden', 'false');
          requestAnimationFrame(() => {
            privacyModal.classList.add('show');
          });
        });
      }
      
      // Close Privacy Policy Modal
      function closePrivacyModal() {
        privacyModal.classList.remove('show');
        privacyModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }
      
      if (closePrivacyBtn) {
        closePrivacyBtn.addEventListener('click', closePrivacyModal);
      }
      
      if (privacyModal) {
        privacyModal.addEventListener('click', (e) => {
          if (e.target === privacyModal) closePrivacyModal();
        });
      }
      
      // Open Terms of Service Modal
      if (termsBtn && termsModal) {
        termsBtn.addEventListener('click', () => {
          document.body.style.overflow = 'hidden';
          termsModal.setAttribute('aria-hidden', 'false');
          requestAnimationFrame(() => {
            termsModal.classList.add('show');
          });
        });
      }
      
      // Close Terms of Service Modal
      function closeTermsModal() {
        termsModal.classList.remove('show');
        termsModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }
      
      if (closeTermsBtn) {
        closeTermsBtn.addEventListener('click', closeTermsModal);
      }
      
      if (termsModal) {
        termsModal.addEventListener('click', (e) => {
          if (e.target === termsModal) closeTermsModal();
        });
      }
      
      // Close modals with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (privacyModal && privacyModal.classList.contains('show')) {
            closePrivacyModal();
          }
          if (termsModal && termsModal.classList.contains('show')) {
            closeTermsModal();
          }
        }
      });
    })();

    // ===== Read More / About Section =====
    (function readMoreHandler() {
      const readMoreBtn = $('#readMoreBtn');
      const aboutSection = $('#aboutSection');
      const card = $('#card');
      let readyPopupTimer = null;
      
      if (!aboutSection) {
        console.warn('About section not found');
        return;
      }
      
      // Since about section is expanded by default, start the popup timer when card shows
      function startPopupTimerIfExpanded() {
        if (aboutSection.classList.contains('expanded')) {
          // Don't start timer if form has already been opened
          if (window.formHasBeenOpened) {
            return;
          }
          // Clear any existing timer
          if (readyPopupTimer) {
            clearTimeout(readyPopupTimer);
          }
          // Start 45 second timer for popup
          readyPopupTimer = setTimeout(() => {
            if (typeof showReadyPopup === 'function') {
              showReadyPopup();
            }
          }, 45000); // 45 seconds
        }
      }
      
      // Clear popup timer when form is opened
      function clearPopupTimer() {
        if (readyPopupTimer) {
          clearTimeout(readyPopupTimer);
          readyPopupTimer = null;
        }
      }
      
      // Expose clearPopupTimer function globally so it can be called when form is opened
      window.clearReadyPopupTimer = clearPopupTimer;
      
      // Listen for form opening events
      window.addEventListener('formOpened', clearPopupTimer);
      
      // If button exists, attach click handler (for backward compatibility)
      if (readMoreBtn) {
        readMoreBtn.addEventListener('click', () => {
          const isExpanded = aboutSection.classList.contains('expanded');
          
          if (isExpanded) {
            // Collapse
            readMoreBtn.classList.remove('expanded');
            aboutSection.classList.remove('expanded');
            if (card) {
              card.classList.remove('about-expanded');
            }
            
            // Clear the popup timer if collapsing
            if (readyPopupTimer) {
              clearTimeout(readyPopupTimer);
              readyPopupTimer = null;
            }
            
            // Smooth scroll back to top of the wrap
            setTimeout(() => {
              const wrap = $('.wrap');
              if (wrap) {
                wrap.scrollTo({ top: 0, behavior: 'smooth' });
              }
            }, 100);
          } else {
            // Expand
            readMoreBtn.classList.add('expanded');
            aboutSection.classList.add('expanded');
            if (card) {
              card.classList.add('about-expanded');
            }
            
            startPopupTimerIfExpanded();
          }
        });
      }
      
      // Start timer when card shows (since about section is expanded by default)
      if (card) {
        // Use MutationObserver to detect when card gets 'show' class
        const observer = new MutationObserver((mutations) => {
          mutations.forEach((mutation) => {
            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
              if (card.classList.contains('show')) {
                startPopupTimerIfExpanded();
              }
            }
          });
        });
        
        observer.observe(card, { attributes: true });
        
        // Also check immediately if card already has 'show' class
        if (card.classList.contains('show')) {
          startPopupTimerIfExpanded();
        }
      }
    })();
    
    // ===== Ready to Work Popup =====
    (function readyPopupHandler() {
      const readyPopup = $('#readyToWorkPopup');
      const closeReadyPopup = $('#closeReadyPopup');
      const readyPopupFormBtn = $('#readyPopupFormBtn');
      const openFormBtn = $('#openFormBtn');
      
      // Track if user has clicked any button to open the form
      window.formHasBeenOpened = false;
      
      // Function to mark form as opened
      window.markFormAsOpened = function() {
        window.formHasBeenOpened = true;
        // Clear popup timer if it exists
        if (typeof window.clearReadyPopupTimer === 'function') {
          window.clearReadyPopupTimer();
        }
      };
      
      if (!readyPopup) {
        console.warn('Ready popup not found');
        return;
      }
      
      // Show popup only if form hasn't been opened
      window.showReadyPopup = function() {
        // Check if form has been opened - if so, don't show popup
        if (window.formHasBeenOpened) {
          return;
        }
        readyPopup.classList.add('show');
        readyPopup.setAttribute('aria-hidden', 'false');
      };
      
      // Hide popup
      function hideReadyPopup() {
        readyPopup.classList.remove('show');
        readyPopup.setAttribute('aria-hidden', 'true');
      }
      
      // Close popup button
      if (closeReadyPopup) {
        closeReadyPopup.addEventListener('click', hideReadyPopup);
      }
      
      // Open form button
      if (readyPopupFormBtn && openFormBtn) {
        readyPopupFormBtn.addEventListener('click', () => {
          hideReadyPopup();
          // Trigger the main form open button
          openFormBtn.click();
        });
      }
      
      // Close on click outside (clicking the backdrop)
      readyPopup.addEventListener('click', (e) => {
        if (e.target === readyPopup) {
          hideReadyPopup();
        }
      });
      
      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && readyPopup.classList.contains('show')) {
          hideReadyPopup();
        }
      });
    })();

    // ===== Form Modal & EmailJS =====
    (function formHandler() {
      // EmailJS Configuration
      const EMAILJS_CONFIG = {
        publicKey: 'koG6eWbBRll3MwQU9', // Your EmailJS public key
        serviceId: 'service_0r9aneq', // Your EmailJS service ID for client emails
        referralServiceId: 'service_3uom8fe', // Your EmailJS service ID for referral emails (separate service)
        templateId: 'template_4uw5t74', // Your EmailJS template ID for client emails
        referralTemplateId: 'template_0gw81ok' // Your EmailJS template ID for referral emails
      };

      // Initialize EmailJS
      emailjs.init(EMAILJS_CONFIG.publicKey);
      
      // SECURITY CHECK: Ensure client and referral services are different
      if (EMAILJS_CONFIG.serviceId === EMAILJS_CONFIG.referralServiceId) {
        console.error('🚨 CRITICAL SECURITY ISSUE: Client and referral services are the same!');
        console.error('🚨 This could cause sensitive client data to be sent to referrers!');
        console.error('🚨 Client Service ID:', EMAILJS_CONFIG.serviceId);
        console.error('🚨 Referral Service ID:', EMAILJS_CONFIG.referralServiceId);
      } else {
        console.log('✅ Security check passed: Client and referral services are different');
        console.log('✅ Client Service ID:', EMAILJS_CONFIG.serviceId);
        console.log('✅ Referral Service ID:', EMAILJS_CONFIG.referralServiceId);
      }

      // ===== Referral System =====
      const REFERRAL_COOKIE_NAME = 'techHelpReferrer';
      const REFERRAL_COOKIE_EXPIRY_DAYS = 30; // Referral attribution lasts 30 days

      // Extract referrer from URL and store in cookie
      function handleReferralTracking() {
        const urlParams = new URLSearchParams(window.location.search);
        const referrerEmail = urlParams.get('ref');
        
        if (referrerEmail && isValidEmail(referrerEmail)) {
          console.log('🎯 Referrer tracked from URL:', referrerEmail);
          
          // Note: We're keeping the ?ref= parameter in the URL for simplicity
          // This way we can always read it directly from the URL
          
          // Optional: Show a subtle indication that referral was detected
          // (for debugging purposes - remove in production)
          if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            console.log('🔗 Referral link detected! Referrer:', referrerEmail);
          }
        }
      }

      // Get current referrer from URL parameter
      function getReferrer() {
        const urlParams = new URLSearchParams(window.location.search);
        const referrer = urlParams.get('ref');
        console.log('🔍 getReferrer() called, URL param value:', referrer);
        return referrer && isValidEmail(referrer) ? referrer : null;
      }

      // Validate email format
      function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      // Initialize referral tracking on page load
      handleReferralTracking();

      // Function to update QR code when referral is detected
      function updateQRCodeForReferral() {
        const referrerEmail = getReferrer();
        if (referrerEmail && isValidEmail(referrerEmail)) {
          console.log('🔄 Updating QR code for referral:', referrerEmail);
          // Regenerate QR code if modal is open
          if (qrCodeInstance && qrModal.classList.contains('show')) {
            generateQRCode();
          }
        }
      }

      // Debug function to check current referrer (for testing)
      window.checkReferrer = function() {
        const referrer = getReferrer();
        if (referrer) {
          console.log('✅ Current referrer from URL:', referrer);
          return referrer;
        } else {
          console.log('❌ No referrer found in URL');
          return null;
        }
      };

      // Debug function to simulate referral (for testing)
      window.simulateReferral = function(email) {
        if (isValidEmail(email)) {
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('ref', email);
          window.history.replaceState({}, document.title, newUrl.toString());
          console.log('🧪 Simulated referral for:', email);
          console.log('🔍 Current referrer after simulation:', getReferrer());
          return true;
        } else {
          console.log('❌ Invalid email format');
          return false;
        }
      };

      // Debug function to test the complete email system
      window.testEmailSystem = function() {
        console.log('🧪 Testing email system...');
        console.log('📧 EmailJS Config:', EMAILJS_CONFIG);
        console.log('📧 Client Service ID:', EMAILJS_CONFIG.serviceId);
        console.log('📧 Referral Service ID:', EMAILJS_CONFIG.referralServiceId);
        console.log('📧 Client Template ID:', EMAILJS_CONFIG.templateId);
        console.log('📧 Referral Template ID:', EMAILJS_CONFIG.referralTemplateId);
        console.log('🔍 Current referrer:', getReferrer());
        console.log('✅ Email system test complete');
      };

      // Debug function to verify service IDs are different
      window.verifyServices = function() {
        console.log('🔍 Service verification:');
        console.log('Client service:', EMAILJS_CONFIG.serviceId);
        console.log('Referral service:', EMAILJS_CONFIG.referralServiceId);
        console.log('Are they different?', EMAILJS_CONFIG.serviceId !== EMAILJS_CONFIG.referralServiceId);
      };

      // NEW: Function to help diagnose EmailJS configuration issues
      window.checkEmailJSConfig = function() {
        console.log('🔍 EMAILJS CONFIGURATION CHECK:');
        console.log('=====================================');
        console.log('Public Key:', EMAILJS_CONFIG.publicKey);
        console.log('Client Service ID:', EMAILJS_CONFIG.serviceId);
        console.log('Referral Service ID:', EMAILJS_CONFIG.referralServiceId);
        console.log('Client Template ID:', EMAILJS_CONFIG.templateId);
        console.log('Referral Template ID:', EMAILJS_CONFIG.referralTemplateId);
        console.log('=====================================');
        
        // Check for common configuration issues
        if (EMAILJS_CONFIG.serviceId === EMAILJS_CONFIG.referralServiceId) {
          console.error('🚨 ISSUE: Client and referral services are the same!');
        }
        
        if (EMAILJS_CONFIG.templateId === EMAILJS_CONFIG.referralTemplateId) {
          console.error('🚨 ISSUE: Client and referral templates are the same!');
        }
        
        console.log('📋 NEXT STEPS:');
        console.log('1. Go to your EmailJS dashboard');
        console.log('2. Check that service_0r9aneq is configured to send emails TO russoc2023@fau.edu');
        console.log('3. Check that service_3uom8fe is configured to send emails TO the referrer email');
        console.log('4. Verify that template_4uw5t74 uses the client.md template');
        console.log('5. Verify that template_0gw81ok uses the refer.md template');
        console.log('6. Make sure each service has the correct "To Email" configuration');
      };

      // Debug function to test referral service directly
      window.testReferralService = async function() {
        console.log('🧪 Testing referral service directly...');
        
        const testParams = {
          to_name: 'Test User',
          to_email: 'therealjesusman@gmail.com',
          from_name: 'Charlie Russo',
          from_email: 'russoc2023@fau.edu',
          reply_to: 'russoc2023@fau.edu',
          email2: 'therealjesusman@gmail.com', // Template recipient variable
          from_name: 'Test Client',
          timestamp: new Date().toLocaleString()
        };
        
        try {
          const response = await emailjs.send(
            EMAILJS_CONFIG.referralServiceId,
            EMAILJS_CONFIG.referralTemplateId,
            testParams,
            EMAILJS_CONFIG.publicKey
          );
          console.log('✅ Test referral email sent:', response);
        } catch (error) {
          console.error('❌ Test referral email failed:', error);
        }
      };

      // NEW: Diagnostic function to test EmailJS services in isolation
      window.diagnoseEmailJS = async function() {
        console.log('🔍 DIAGNOSTIC: Testing EmailJS services in isolation...');
        
        // Test 1: Send ONLY client email
        console.log('🧪 TEST 1: Sending ONLY client email...');
        const clientOnlyParams = {
          to_name: 'Charlie Russo',
          to_email: 'russoc2023@fau.edu',
          from_name: 'Diagnostic Test',
          from_email: 'test@example.com',
          reply_to: 'test@example.com',
          name: 'Diagnostic Test',
          email: 'test@example.com',
          phone: 'Test Phone',
          urgency: 'medium',
          category: 'web',
          description: 'This is a diagnostic test - client email only',
          device: 'test.com',
          project_budget: '100-500 USD',
          project_category: 'Website Development',
          project_description: 'This is a diagnostic test - client email only',
          existing_website: 'test.com',
          client_name: 'Diagnostic Test',
          client_email: 'test@example.com',
          timestamp: new Date().toLocaleString()
        };
        
        try {
          const clientResponse = await emailjs.send(
            EMAILJS_CONFIG.serviceId,
            EMAILJS_CONFIG.templateId,
            clientOnlyParams,
            EMAILJS_CONFIG.publicKey
          );
          console.log('✅ CLIENT EMAIL ONLY sent successfully:', clientResponse);
          console.log('🔍 Check if referrer received this email (they should NOT)');
        } catch (error) {
          console.error('❌ Client email failed:', error);
        }
        
        // Wait 2 seconds between tests
        setTimeout(async () => {
          // Test 2: Send ONLY referral email
          console.log('🧪 TEST 2: Sending ONLY referral email...');
          const referralOnlyParams = {
            to_name: 'Test Referrer',
            to_email: 'therealjesusman@gmail.com',
            from_name: 'Charlie Russo',
            from_email: 'russoc2023@fau.edu',
            reply_to: 'russoc2023@fau.edu',
            email2: 'therealjesusman@gmail.com',
            from_email2: 'therealjesusman@gmail.com',
            from_name: 'Diagnostic Test Client',
            timestamp: new Date().toLocaleString()
          };
          
          try {
            const referralResponse = await emailjs.send(
              EMAILJS_CONFIG.referralServiceId,
              EMAILJS_CONFIG.referralTemplateId,
              referralOnlyParams,
              EMAILJS_CONFIG.publicKey
            );
            console.log('✅ REFERRAL EMAIL ONLY sent successfully:', referralResponse);
            console.log('🔍 Check if referrer received this email (they SHOULD)');
          } catch (error) {
            console.error('❌ Referral email failed:', error);
          }
        }, 2000);
      };

      // Debug function to manually check cookie
      window.checkCookie = function() {
        console.log('🍪 Cookie name:', REFERRAL_COOKIE_NAME);
        console.log('🍪 Cookie value:', getCookie(REFERRAL_COOKIE_NAME));
        console.log('🍪 All cookies:', document.cookie);
      };
      

      // Modal elements
      const modal = $('#formModal');
      const openBtn = $('#openFormBtn');
      const closeBtn = $('#closeFormBtn');
      const cancelBtn = $('#cancelBtn');
      const form = $('#helpForm');
      const submitBtn = $('#submitBtn');
      const loadingState = $('#loadingState');
      const successMessage = $('#successMessage');
      

      // Cookie utilities
      const COOKIE_NAME = 'techHelpFormData';
      const COOKIE_EXPIRY_DAYS = 7;

      function setCookie(name, value, days) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = `${name}=${encodeURIComponent(value)};expires=${expires.toUTCString()};path=/`;
      }

      function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
          let c = ca[i];
          while (c.charAt(0) === ' ') c = c.substring(1, c.length);
          if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));
        }
        return null;
      }

      function deleteCookie(name) {
        document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`;
      }

      // Save form data to cookies
      function saveFormData() {
        const formData = new FormData(form);
        const data = {};
        for (let [key, value] of formData.entries()) {
          if (value.trim()) data[key] = value;
        }
        if (Object.keys(data).length > 0) {
          setCookie(COOKIE_NAME, JSON.stringify(data), COOKIE_EXPIRY_DAYS);
        }
      }

      // Load form data from cookies
      function loadFormData() {
        const savedData = getCookie(COOKIE_NAME);
        if (savedData) {
          try {
            const data = JSON.parse(savedData);
            Object.entries(data).forEach(([key, value]) => {
              const field = form.querySelector(`[name="${key}"]`);
              if (field) {
                field.value = value;
                
                // Trigger input event for phone field to reformat
                if (key === 'phone' && field.id === 'phone') {
                  field.dispatchEvent(new Event('input', { bubbles: true }));
                }
              }
            });
          } catch (e) {
            console.warn('Failed to load saved form data:', e);
          }
        }
      }

      // Auto-save form data on input
      function setupAutoSave() {
        const inputs = form.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
          input.addEventListener('input', saveFormData);
          input.addEventListener('change', saveFormData);
        });
      }

      // Open modal
      function openModal() {
        // Mark form as opened to prevent popup
        if (typeof window.markFormAsOpened === 'function') {
          window.markFormAsOpened();
        }
        
        document.body.style.overflow = 'hidden';
        modal.setAttribute('aria-hidden', 'false');
        loadFormData();
        
        // Load saved country selection when opening modal
        setTimeout(() => {
          const savedCountrySelection = getCookie('phoneCountrySelection');
          if (savedCountrySelection) {
            try {
              const { code, dialCode } = JSON.parse(savedCountrySelection);
              if (code && dialCode) {
                const flagElement = $('#selectedFlag');
                const codeElement = $('#selectedCode');
                const countryCodeInput = $('#phoneCountryCode');
                
                if (flagElement && codeElement && countryCodeInput) {
                  flagElement.src = `media/flags/${code}.svg`;
                  flagElement.alt = `${code.toUpperCase()} Flag`;
                  codeElement.textContent = dialCode;
                  countryCodeInput.value = dialCode;
                }
              }
            } catch (e) {
              console.warn('Failed to restore country selection in modal:', e);
            }
          }
        }, 100);
        
        // Trigger smooth fade in
        requestAnimationFrame(() => {
          modal.classList.add('show');
          
          // Animate form elements one by one after container appears
          setTimeout(() => {
            animateFormElements();
          }, 700); // Wait for form container to fully appear
        });
      }
      
      // Animate form elements one by one
      function animateFormElements() {
        const formGroups = form.querySelectorAll('.form-group');
        const formActions = form.querySelector('.form-actions');
        
        // Animate each form group with typing effect
        formGroups.forEach((group, index) => {
          setTimeout(() => {
            // Animate the group container
            group.classList.add('animate-in');
            
            // Animate label and input separately
            const label = group.querySelector('.form-label');
            const input = group.querySelector('.form-input, .form-textarea, .form-select');
            
            if (label) {
              setTimeout(() => {
                label.classList.add('animate-in');
              }, 200);
            }
            
            if (input) {
              setTimeout(() => {
                input.classList.add('animate-in');
                
                // Focus first empty field
                if (index === 0) {
                  setTimeout(() => {
                    const firstEmpty = form.querySelector('input:not([value]), input[value=""]') || $('#name');
                    firstEmpty.focus();
                  }, 300);
                }
              }, 400);
            }
          }, index * 300); // Stagger each group by 300ms
        });
        
        // Animate form actions last
        if (formActions) {
          setTimeout(() => {
            formActions.style.opacity = '0';
            formActions.style.transform = 'translateY(20px)';
            formActions.style.transition = 'all 0.6s cubic-bezier(0.16, 1, 0.3, 1)';
            
            requestAnimationFrame(() => {
              formActions.style.opacity = '1';
              formActions.style.transform = 'translateY(0)';
            });
          }, formGroups.length * 300 + 200);
        }
      }

      // Close modal
      function closeModal() {
        modal.classList.remove('show');
        modal.setAttribute('aria-hidden', 'true');
        
        // Close country dropdown if open (defined later in the code)
        const countryDropdownElement = $('#countryDropdown');
        const countryDropdownBackdropElement = $('#countryDropdownBackdrop');
        if (countryDropdownElement && countryDropdownElement.style.display === 'block') {
          countryDropdownElement.style.display = 'none';
          if (countryDropdownBackdropElement) {
            countryDropdownBackdropElement.style.display = 'none';
          }
          const countrySelectorElement = $('#countrySelector');
          if (countrySelectorElement) {
            countrySelectorElement.classList.remove('open');
          }
        }
        
        // Restore body overflow
        document.body.style.overflow = '';
        
        // Wait for fade out animation to complete
        setTimeout(() => {
          resetForm();
        }, 500); // Match the CSS transition duration
      }

      // Reset form (but keep saved data)
      function resetForm() {
        // Hide loading and success states
        loadingState.classList.remove('show');
        successMessage.classList.remove('show');
        submitBtn.disabled = false;
        
        // Restore form fields
        const formGroups = form.querySelectorAll('.form-group');
        const formActions = form.querySelector('.form-actions');
        
        formGroups.forEach(group => {
          group.style.opacity = '1';
          group.style.pointerEvents = 'auto';
          group.style.display = '';
        });
        
        if (formActions) {
          formActions.style.opacity = '1';
          formActions.style.pointerEvents = 'auto';
          formActions.style.display = '';
        }
        
        // Don't reset form data - keep user input
      }

      // Clear form and cookies
      function clearFormData() {
        form.reset();
        deleteCookie(COOKIE_NAME);
        // Note: We intentionally don't clear phoneCountrySelection cookie here
        // so the user's country preference persists across submissions
      }

      // Show loading state
      function showLoading() {
        // Fade out form fields
        const formGroups = form.querySelectorAll('.form-group');
        const formActions = form.querySelector('.form-actions');
        
        formGroups.forEach(group => {
          group.style.opacity = '0';
          group.style.pointerEvents = 'none';
        });
        
        if (formActions) {
          formActions.style.opacity = '0';
          formActions.style.pointerEvents = 'none';
        }
        
        // Show loading animation
        if (loadingState) {
          setTimeout(() => {
            loadingState.classList.add('show');
          }, 300); // Wait for form fade out
        }
        
        if (submitBtn) {
          submitBtn.disabled = true;
        }
      }

      // Show success message
      function showSuccess() {
        // Hide loading
        if (loadingState) {
          loadingState.classList.remove('show');
        }
        
        // Hide form fields
        const formGroups = form.querySelectorAll('.form-group');
        const formActions = form.querySelector('.form-actions');
        
        formGroups.forEach(group => {
          group.style.opacity = '0';
          group.style.pointerEvents = 'none';
        });
        
        if (formActions) {
          formActions.style.opacity = '0';
          formActions.style.pointerEvents = 'none';
        }
        
        if (successMessage) {
          successMessage.classList.add('show');
        }
        
        // Clear saved data on successful submission
        deleteCookie(COOKIE_NAME);
        setTimeout(() => {
          closeModal();
          clearFormData(); // Clear form after successful submission
        }, 4000); // Increased to 4 seconds to give more time to read
      }

      // Show error
      function showError(message) {
        loadingState.classList.remove('show');
        submitBtn.disabled = false;
        alert('Error: ' + message + '\n\nPlease try again or contact russoc2023@fau.edu directly.');
      }

      // Format form data for client email template
      function formatFormData(formData) {
        const budgetLabels = {
          'medium': '100-500 USD',
          'high': '500-1000 USD',
          'very-high': '1000-2000 USD',
          'critical': '2000+'
        };

        const categoryLabels = {
          'web': 'Website Development',
          'software': 'Backend Development',
          '3d': '3D-Printing / 3D-Modeling',
          'electronics': 'Electronics Prototyping',
          'training': 'Software Training',
          'logo': 'Logo Design',
          'graphic': 'Graphic Design for Clothes',
          'templates': 'Custom Social Media / Email Templates',
          '2d-animation': '2D Animation',
          '3d-animation': '3D Animation',
          'other': 'Other'
        };

        // Get form values
        const name = formData.get('name') || '';
        const email = formData.get('email') || '';
        const phoneNumber = formData.get('phone') || '';
        const phoneCode = formData.get('phoneCountryCode') || '+1';
        const phone = phoneNumber ? `${phoneCode} ${phoneNumber}` : 'Not provided';
        const urgency = formData.get('urgency') || '';
        const category = formData.get('category') || '';
        const description = formData.get('description') || '';
        const website = formData.get('device') || 'Not provided';
        
        return {
          // Email routing - CLIENT EMAIL ONLY GOES TO CHARLIE
          to_name: 'Charlie Russo',
          to_email: 'russoc2023@fau.edu',
          // NO CC - this ensures only Charlie gets the detailed client email
          
          // Client information
          from_name: name,
          from_email: email,
          reply_to: email,
          
          // All form fields with clear names
          name: name,
          email: email,
          phone: phone,
          urgency: urgency,
          category: category,
          description: description,
          device: website,
          
          // Formatted project details
          project_budget: budgetLabels[urgency] || urgency,
          project_category: categoryLabels[category] || category,
          project_description: description,
          existing_website: website,
          
          // Additional fields
          client_name: name,
          client_email: email,
          timestamp: new Date().toLocaleString(),
          
          // Complete message summary
          message: `NEW PROJECT INQUIRY

Client: ${name}
Email: ${email}
Phone: ${phone}
Website: ${website}

Project Budget: ${budgetLabels[urgency] || urgency}
Project Category: ${categoryLabels[category] || category}

Project Description:
${description}

Submitted: ${new Date().toLocaleString()}`
        };
      }

      // Format data for referral email template
      function formatReferralData(formData, referrerEmail) {
        const name = formData.get('name') || '';
        
        // Extract referrer name from email (everything before @)
        const referrerName = referrerEmail.split('@')[0].replace(/[._-]/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        
        return {
          // Email routing for referrer - REFERRAL EMAIL ONLY GOES TO REFERRER
          to_name: referrerName,
          to_email: referrerEmail,
          from_name: 'Charlie Russo',
          from_email: 'russoc2023@fau.edu',
          reply_to: 'russoc2023@fau.edu',
          
          // EmailJS template variables (matching your template configuration)
          email2: referrerEmail, // This is what your template expects for recipient
          from_email2: referrerEmail, // Alternative variable name for referral email
          from_name: name, // Client's name (safe to share - just the name)
          timestamp: new Date().toLocaleString()
          
          // NOTE: This template does NOT include sensitive client information like:
          // - Client email address
          // - Phone number
          // - Project budget
          // - Detailed project description
          // - Website information
          // Only the client's name is shared as a thank you
        };
      }

      // Submit form
      async function submitForm(e) {
        e.preventDefault();
        
        // Check if EmailJS is configured
        if (!EMAILJS_CONFIG.publicKey || EMAILJS_CONFIG.publicKey === 'YOUR_PUBLIC_KEY') {
          alert('EmailJS is not configured yet. Please provide your EmailJS credentials.');
          return;
        }

        showLoading();

        try {
          const formData = new FormData(form);
          const clientTemplateParams = formatFormData(formData);

          // Send client email (main inquiry)
          console.log('🔍 Sending client email with template:', EMAILJS_CONFIG.templateId);
          console.log('🔍 Sending client email with service:', EMAILJS_CONFIG.serviceId);
          console.log('🔍 Client template params:', clientTemplateParams);
          console.log('🔍 CRITICAL: Client email should go TO:', clientTemplateParams.to_email);
          console.log('🔍 CRITICAL: Client email FROM:', clientTemplateParams.from_email);
          console.log('🔍 CRITICAL: Client email REPLY_TO:', clientTemplateParams.reply_to);
          console.log('🔍 SECURITY: Client email contains sensitive data - should ONLY go to Charlie');
          
          const clientResponse = await emailjs.send(
            EMAILJS_CONFIG.serviceId,
            EMAILJS_CONFIG.templateId,
            clientTemplateParams,
            EMAILJS_CONFIG.publicKey
          );

          console.log('✅ Client email response:', clientResponse);

          if (clientResponse.status !== 200 && clientResponse.text !== 'OK') {
            throw new Error('Failed to send client email. Status: ' + clientResponse.status);
          }

          // Check for referrer and send referral email if exists
          const referrerEmail = getReferrer();
          console.log('🔍 Checking for referrer:', referrerEmail);
          console.log('🔍 Is valid email?', referrerEmail ? isValidEmail(referrerEmail) : 'No referrer found');
          
          if (referrerEmail && isValidEmail(referrerEmail)) {
            console.log('✅ Referrer found! Sending referral email...');
            console.log('🔍 SECURITY CHECK: Verifying referral email does not contain sensitive client data...');
            
            try {
              const referralTemplateParams = formatReferralData(formData, referrerEmail);
              
              // SECURITY CHECK: Ensure referral email doesn't contain sensitive data
              const sensitiveFields = ['email', 'phone', 'description', 'device', 'project_budget', 'project_description', 'existing_website'];
              const hasSensitiveData = sensitiveFields.some(field => referralTemplateParams[field]);
              
              if (hasSensitiveData) {
                console.error('🚨 SECURITY VIOLATION: Referral email contains sensitive client data!');
                console.error('🚨 Sensitive fields found:', sensitiveFields.filter(field => referralTemplateParams[field]));
                throw new Error('Security violation: Referral email contains sensitive client data');
              } else {
                console.log('✅ Security check passed: Referral email contains no sensitive client data');
              }
              
              // Send referral thank you email
              console.log('🔍 Sending referral email with template:', EMAILJS_CONFIG.referralTemplateId);
              console.log('🔍 Sending referral email with service:', EMAILJS_CONFIG.referralServiceId);
              console.log('🔍 Referral template params:', referralTemplateParams);
              console.log('🔍 CRITICAL: Referral email should go TO:', referralTemplateParams.to_email);
              console.log('🔍 CRITICAL: Referral email FROM:', referralTemplateParams.from_email);
              console.log('🔍 CRITICAL: Email2 (template recipient):', referralTemplateParams.email2);
              console.log('🔍 CRITICAL: From_email2 (referral email):', referralTemplateParams.from_email2);
              console.log('🔍 CRITICAL: Client name (from_name):', referralTemplateParams.from_name);
              console.log('🔍 CRITICAL: Timestamp:', referralTemplateParams.timestamp);
              console.log('🔍 SECURITY: Referral email contains NO sensitive data - only client name and thank you message');
              
              const referralResponse = await emailjs.send(
                EMAILJS_CONFIG.referralServiceId,
                EMAILJS_CONFIG.referralTemplateId,
                referralTemplateParams,
                EMAILJS_CONFIG.publicKey
              );

              console.log('✅ Referral email response:', referralResponse);
              console.log('📧 Referral email sent to:', referrerEmail);
              
              // Don't fail the whole process if referral email fails
              if (referralResponse.status !== 200 && referralResponse.text !== 'OK') {
                console.warn('⚠️ Referral email failed, but continuing with success flow. Status:', referralResponse.status);
              }
            } catch (referralError) {
              console.error('❌ Failed to send referral email:', referralError);
              console.error('❌ Referral error details:', {
                message: referralError.message,
                text: referralError.text,
                status: referralError.status
              });
              // Continue with success flow even if referral email fails
            }
          } else {
            console.log('❌ No referrer found or invalid email. Skipping referral email.');
          }

          showSuccess();
        } catch (error) {
          showError(error.text || error.message || 'Failed to send email. Please try again or contact us directly.');
        }
      }

      // Event listeners
      openBtn.addEventListener('click', openModal);
      closeBtn.addEventListener('click', closeModal);
      cancelBtn.addEventListener('click', closeModal);
      form.addEventListener('submit', submitForm);
      
      // Add success close button listener
      const successCloseBtn = $('#successCloseBtn');
      if (successCloseBtn) {
        successCloseBtn.addEventListener('click', closeModal);
      }

      // Close modal when clicking outside
      modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
      });

      // Close modal with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          // Check country dropdown first (highest priority)
          const countryDropdownElement = $('#countryDropdown');
          if (countryDropdownElement && countryDropdownElement.style.display === 'block') {
            const countryDropdownBackdropElement = $('#countryDropdownBackdrop');
            countryDropdownElement.style.display = 'none';
            if (countryDropdownBackdropElement) {
              countryDropdownBackdropElement.style.display = 'none';
            }
            const countrySelectorElement = $('#countrySelector');
            if (countrySelectorElement) {
              countrySelectorElement.classList.remove('open');
            }
            return; // Stop here, don't close the modal
          }
          
          // Then check modals
          if (modal.classList.contains('show')) {
            closeModal();
          }
          if (qrModal.classList.contains('show')) {
            closeQrModal();
          }
        }
      });

      // QR Code functionality
      const qrButton = $('#qrButton');
      const qrModal = $('#qrModal');
      const closeQrBtn = $('#closeQrBtn');
      const qrCodeContainer = $('#qrCode');
      const qrDescription = $('#qrDescription');

      // Dynamic QR Code instance
      let qrCodeInstance = null;
      
      // Animation configuration
      const QR_ANIMATION_CONFIG = {
        sections: 49, // Grid sections used when randomizeOrder is false
        delayBetweenSections: 0.04,
        animationDuration: 0.45,
        staggerWithinSection: 0.008,
        // New: randomized reveal configuration
        randomizeOrder: true,
        maxRandomDelay: 0.6, // seconds - cap for per-element random delay
        // Retro blink settings
        blinkEnabled: true,
        blinkRatio: 0.14, // ~14% of modules blink
        blinkDurationRange: [0.6, 0.95],
        blinkRepeat: 2 // number of blinks
      };

      // Generate QR code with current URL (including referral if present)
      function generateQRCode() {
        // Get current URL with all parameters
        const currentUrl = window.location.href;
        const urlParams = new URLSearchParams(window.location.search);
        const referrerEmail = urlParams.get('ref');
        
        // Update description based on whether it's a referral link
        if (referrerEmail && isValidEmail(referrerEmail)) {
          qrDescription.textContent = `Scan this QR code to visit with referral from ${referrerEmail}`;
        } else {
          qrDescription.textContent = 'Scan this QR code with your phone\'s camera to visit this website';
        }

        // Clear existing QR code
        if (qrCodeInstance) {
          qrCodeInstance.clear();
        }

        // Clear container to reset animation
        qrCodeContainer.innerHTML = '';

        // Determine QR code size based on screen size
        const isMobile = window.innerWidth <= 480;
        const qrSize = isMobile ? 240 : 280;

        // Create new QR code instance with updated styling
        qrCodeInstance = new QRCodeStyling({
          width: qrSize, // Responsive QR code size
          height: qrSize, // Responsive QR code size
          data: currentUrl,
          margin: 6, // Smaller margin
          type: 'svg',
          // Increase error correction for cleaner module shapes and better visual merging
          qrOptions: {
            errorCorrectionLevel: 'Q'
          },
          backgroundOptions: { 
            color: 'transparent' // Transparent background
          },
          // Use simple dots for data modules
          dotsOptions: { 
            type: 'dots',
            color: '#00ff41'
          },
          cornersSquareOptions: { 
            type: 'extra-rounded', // Rounded finder patterns for better visual appeal
            color: '#00ff41'
          },
          cornersDotOptions: { 
            type: 'dot', // Rounded corner dots
            color: '#00ff41'
          },
          imageOptions: { 
            crossOrigin: 'anonymous', 
            margin: 6, 
            imageSize: 0.25, 
            hideBackgroundDots: false 
          }
        });

        // Generate QR code in background first
        qrCodeInstance.append(qrCodeContainer);
        
        // Wait for SVG to be fully rendered, then animate by sections
        setTimeout(() => {
          const qrSvg = qrCodeContainer.querySelector('svg');
          if (qrSvg) {
            // Get all drawable elements from the SVG
            const rects = Array.from(qrSvg.querySelectorAll('rect'));
            const paths = Array.from(qrSvg.querySelectorAll('path'));
            const circles = Array.from(qrSvg.querySelectorAll('circle'));
            const polygons = Array.from(qrSvg.querySelectorAll('polygon'));
            
            // Combine all elements
            const allElements = [...rects, ...paths, ...circles, ...polygons];
            
            if (allElements.length === 0) {
              console.log('⚠️ No QR code elements found');
              return;
            }
            
            // Get SVG dimensions to calculate sections
            const svgRect = qrSvg.getBoundingClientRect();
            const svgWidth = svgRect.width;
            const svgHeight = svgRect.height;
            
            if (QR_ANIMATION_CONFIG.randomizeOrder) {
              // Randomized per-element delay
              const maxDelay = Math.max(0.05, QR_ANIMATION_CONFIG.maxRandomDelay || 0.6);
              allElements.forEach((el) => {
                const delay = Math.random() * maxDelay;
                el.style.animationDelay = `${delay.toFixed(3)}s`;

                // Optional retro blink on a subset of modules
                if (QR_ANIMATION_CONFIG.blinkEnabled && Math.random() < (QR_ANIMATION_CONFIG.blinkRatio || 0)) {
                  const [minDur, maxDur] = QR_ANIMATION_CONFIG.blinkDurationRange || [0.6, 0.95];
                  const dur = (minDur + Math.random() * (maxDur - minDur)).toFixed(2);
                  const extraDelay = (Math.random() * 0.25).toFixed(2); // small extra jitter
                  const repeat = Math.max(1, QR_ANIMATION_CONFIG.blinkRepeat || 1);
                  el.style.setProperty('--qr-blink-animation', `dotBlink ${dur}s ease-in-out ${extraDelay}s ${repeat}`);
                }
              });
              console.log(`🎲 Animating QR code with randomized delays (max ${maxDelay}s) for ${allElements.length} elements`);
            } else {
              // Section-based sequencing (previous behavior)
              const sectionsPerRow = Math.ceil(Math.sqrt(QR_ANIMATION_CONFIG.sections));
              const sectionsPerCol = Math.ceil(QR_ANIMATION_CONFIG.sections / sectionsPerRow);
              const sectionWidth = svgWidth / sectionsPerRow;
              const sectionHeight = svgHeight / sectionsPerCol;
              const sections = Array.from({ length: QR_ANIMATION_CONFIG.sections }, () => []);
              allElements.forEach(element => {
                const bbox = element.getBBox();
                const centerX = bbox.x + bbox.width / 2;
                const centerY = bbox.y + bbox.height / 2;
                const sectionX = Math.floor(centerX / sectionWidth);
                const sectionY = Math.floor(centerY / sectionHeight);
                const sectionIndex = Math.min(sectionY * sectionsPerRow + sectionX, QR_ANIMATION_CONFIG.sections - 1);
                sections[sectionIndex].push(element);
              });
              sections.forEach((sectionElements, sectionIndex) => {
                if (sectionElements.length === 0) return;
                const sectionDelay = sectionIndex * QR_ANIMATION_CONFIG.delayBetweenSections;
                sectionElements.forEach((element, elementIndex) => {
                  const elementDelay = sectionDelay + (elementIndex * QR_ANIMATION_CONFIG.staggerWithinSection);
                  element.style.animationDelay = `${elementDelay}s`;

                  // Optional retro blink on a subset of modules
                  if (QR_ANIMATION_CONFIG.blinkEnabled && Math.random() < (QR_ANIMATION_CONFIG.blinkRatio || 0)) {
                    const [minDur, maxDur] = QR_ANIMATION_CONFIG.blinkDurationRange || [0.6, 0.95];
                    const dur = (minDur + Math.random() * (maxDur - minDur)).toFixed(2);
                    const extraDelay = (Math.random() * 0.25).toFixed(2);
                    const repeat = Math.max(1, QR_ANIMATION_CONFIG.blinkRepeat || 1);
                    element.style.setProperty('--qr-blink-animation', `dotBlink ${dur}s ease-in-out ${extraDelay}s ${repeat}`);
                  }
                });
              });
              console.log(`🎨 Animating QR code in ${QR_ANIMATION_CONFIG.sections} sections with ${allElements.length} total elements`);
            }
          }
        }, 100); // Increased delay to ensure SVG is fully rendered
      }

      function openQrModal() {
        // Clear any existing QR code first
        if (qrCodeContainer) {
          qrCodeContainer.innerHTML = '';
        }
        
        // Generate fresh QR code with current URL before opening
        generateQRCode();
        
        qrModal.style.display = 'grid';
        requestAnimationFrame(() => {
          qrModal.classList.add('show');
          qrModal.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
        });
      }

      function closeQrModal() {
        qrModal.classList.remove('show');
        qrModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        // Clear the QR code instance and container immediately
        if (qrCodeInstance) {
          qrCodeInstance = null;
        }
        if (qrCodeContainer) {
          qrCodeContainer.innerHTML = '';
        }
        
        setTimeout(() => {
          qrModal.style.display = 'none';
        }, 300);
      }

      // QR Code Event Listeners
      qrButton.addEventListener('click', openQrModal);
      closeQrBtn.addEventListener('click', closeQrModal);
      qrModal.addEventListener('click', (e) => {
        if (e.target === qrModal) closeQrModal();
      });

      // Regenerate QR code when URL changes (for referral links)
      window.addEventListener('popstate', generateQRCode);
      
      // Regenerate QR code when window is resized (for responsive sizing)
      window.addEventListener('resize', debounce(() => {
        if (qrCodeInstance && qrModal.classList.contains('show')) {
          generateQRCode();
        }
      }, 250));
      
      // Debounce function for resize events
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Debug function to test QR code generation
      window.testQRCode = function() {
        console.log('🧪 Testing QR code generation...');
        console.log('🔍 Current URL:', window.location.href);
        console.log('🔍 URL params:', new URLSearchParams(window.location.search).toString());
        generateQRCode();
        console.log('✅ QR code regenerated');
      };

      // Debug function to test QR code animation
      window.testQRAnimation = function(sections = 20, sectionDelay = 0.1) {
        console.log('🎨 Testing QR code animation...');
        QR_ANIMATION_CONFIG.sections = sections;
        QR_ANIMATION_CONFIG.delayBetweenSections = sectionDelay;
        console.log('🎨 Animation config:', QR_ANIMATION_CONFIG);
        generateQRCode();
        console.log('✅ QR code animation updated');
      };

      // Debug function to change animation style
      window.setQRAnimationStyle = function(style) {
        console.log('🎨 Setting QR animation style:', style);
        switch(style) {
          case 'fast':
            QR_ANIMATION_CONFIG.sections = 15;
            QR_ANIMATION_CONFIG.delayBetweenSections = 0.05;
            QR_ANIMATION_CONFIG.staggerWithinSection = 0.01;
            break;
          case 'slow':
            QR_ANIMATION_CONFIG.sections = 25;
            QR_ANIMATION_CONFIG.delayBetweenSections = 0.15;
            QR_ANIMATION_CONFIG.staggerWithinSection = 0.03;
            break;
          case 'smooth':
            QR_ANIMATION_CONFIG.sections = 20;
            QR_ANIMATION_CONFIG.delayBetweenSections = 0.08;
            QR_ANIMATION_CONFIG.staggerWithinSection = 0.015;
            break;
          case 'chunky':
            QR_ANIMATION_CONFIG.sections = 12;
            QR_ANIMATION_CONFIG.delayBetweenSections = 0.12;
            QR_ANIMATION_CONFIG.staggerWithinSection = 0.005;
            break;
          case 'detailed':
            QR_ANIMATION_CONFIG.sections = 30;
            QR_ANIMATION_CONFIG.delayBetweenSections = 0.06;
            QR_ANIMATION_CONFIG.staggerWithinSection = 0.02;
            break;
          default:
            console.log('Available styles: fast, slow, smooth, chunky, detailed');
            return;
        }
        generateQRCode();
        console.log('✅ Animation style updated to:', style);
      };

      // Debug function to see section breakdown
      window.debugQRSections = function() {
        const qrSvg = qrCodeContainer.querySelector('svg');
        if (!qrSvg) {
          console.log('❌ No QR code found. Generate one first.');
          return;
        }
        
        const rects = Array.from(qrSvg.querySelectorAll('rect'));
        const paths = Array.from(qrSvg.querySelectorAll('path'));
        const circles = Array.from(qrSvg.querySelectorAll('circle'));
        const polygons = Array.from(qrSvg.querySelectorAll('polygon'));
        const allElements = [...rects, ...paths, ...circles, ...polygons];
        
        console.log(`📊 QR Code Debug Info:`);
        console.log(`Total elements: ${allElements.length}`);
        console.log(`Sections: ${QR_ANIMATION_CONFIG.sections}`);
        console.log(`Section delay: ${QR_ANIMATION_CONFIG.delayBetweenSections}s`);
        console.log(`Element stagger: ${QR_ANIMATION_CONFIG.staggerWithinSection}s`);
      };

      // Initialize functionality
      window.addEventListener('beforeunload', saveFormData);
      setupAutoSave();
      document.addEventListener('DOMContentLoaded', loadFormData);
      
      // ===== Country Code Selector =====
      const countrySelector = $('#countrySelector');
      const countryDropdown = $('#countryDropdown');
      const countryDropdownBackdrop = $('#countryDropdownBackdrop');
      const countryDropdownCloseBtn = $('#closeCountryDropdown');
      const countryList = $('#countryList');
      const countrySearch = $('#countrySearch');
      const selectedFlag = $('#selectedFlag');
      const selectedCode = $('#selectedCode');
      const phoneCountryCode = $('#phoneCountryCode');
      const phoneInput = $('#phone');
      
      // Popular countries and their data
      const countries = [
        { code: 'us', name: 'United States', dialCode: '+1' },
        { code: 'gb', name: 'United Kingdom', dialCode: '+44' },
        { code: 'ca', name: 'Canada', dialCode: '+1' },
        { code: 'au', name: 'Australia', dialCode: '+61' },
        { code: 'de', name: 'Germany', dialCode: '+49' },
        { code: 'fr', name: 'France', dialCode: '+33' },
        { code: 'es', name: 'Spain', dialCode: '+34' },
        { code: 'it', name: 'Italy', dialCode: '+39' },
        { code: 'nl', name: 'Netherlands', dialCode: '+31' },
        { code: 'se', name: 'Sweden', dialCode: '+46' },
        { code: 'no', name: 'Norway', dialCode: '+47' },
        { code: 'dk', name: 'Denmark', dialCode: '+45' },
        { code: 'fi', name: 'Finland', dialCode: '+358' },
        { code: 'ch', name: 'Switzerland', dialCode: '+41' },
        { code: 'at', name: 'Austria', dialCode: '+43' },
        { code: 'be', name: 'Belgium', dialCode: '+32' },
        { code: 'ie', name: 'Ireland', dialCode: '+353' },
        { code: 'nz', name: 'New Zealand', dialCode: '+64' },
        { code: 'jp', name: 'Japan', dialCode: '+81' },
        { code: 'kr', name: 'South Korea', dialCode: '+82' },
        { code: 'cn', name: 'China', dialCode: '+86' },
        { code: 'in', name: 'India', dialCode: '+91' },
        { code: 'sg', name: 'Singapore', dialCode: '+65' },
        { code: 'hk', name: 'Hong Kong', dialCode: '+852' },
        { code: 'mx', name: 'Mexico', dialCode: '+52' },
        { code: 'br', name: 'Brazil', dialCode: '+55' },
        { code: 'ar', name: 'Argentina', dialCode: '+54' },
        { code: 'cl', name: 'Chile', dialCode: '+56' },
        { code: 'co', name: 'Colombia', dialCode: '+57' },
        { code: 'pe', name: 'Peru', dialCode: '+51' },
        { code: 'za', name: 'South Africa', dialCode: '+27' },
        { code: 'ng', name: 'Nigeria', dialCode: '+234' },
        { code: 'eg', name: 'Egypt', dialCode: '+20' },
        { code: 'ae', name: 'United Arab Emirates', dialCode: '+971' },
        { code: 'sa', name: 'Saudi Arabia', dialCode: '+966' },
        { code: 'il', name: 'Israel', dialCode: '+972' },
        { code: 'tr', name: 'Turkey', dialCode: '+90' },
        { code: 'ru', name: 'Russia', dialCode: '+7' },
        { code: 'pl', name: 'Poland', dialCode: '+48' },
        { code: 'cz', name: 'Czech Republic', dialCode: '+420' },
        { code: 'gr', name: 'Greece', dialCode: '+30' },
        { code: 'pt', name: 'Portugal', dialCode: '+351' },
        { code: 'ro', name: 'Romania', dialCode: '+40' },
        { code: 'hu', name: 'Hungary', dialCode: '+36' },
        { code: 'th', name: 'Thailand', dialCode: '+66' },
        { code: 'my', name: 'Malaysia', dialCode: '+60' },
        { code: 'id', name: 'Indonesia', dialCode: '+62' },
        { code: 'ph', name: 'Philippines', dialCode: '+63' },
        { code: 'vn', name: 'Vietnam', dialCode: '+84' },
        { code: 'pk', name: 'Pakistan', dialCode: '+92' },
        { code: 'bd', name: 'Bangladesh', dialCode: '+880' },
        { code: 'ua', name: 'Ukraine', dialCode: '+380' },
      ];
      
      // Sort countries alphabetically by name
      countries.sort((a, b) => a.name.localeCompare(b.name));
      
      // Populate country list
      function populateCountryList(filterText = '') {
        const filteredCountries = countries.filter(country => 
          country.name.toLowerCase().includes(filterText.toLowerCase()) ||
          country.dialCode.includes(filterText)
        );
        
        countryList.innerHTML = filteredCountries.map(country => `
          <div class="country-item" data-code="${country.code}" data-dial="${country.dialCode}">
            <img src="media/flags/${country.code}.svg" alt="${country.name}" class="country-item-flag" onerror="this.style.display='none'">
            <span class="country-item-name">${country.name}</span>
            <span class="country-item-code">${country.dialCode}</span>
          </div>
        `).join('');
        
        // Add click handlers to country items
        countryList.querySelectorAll('.country-item').forEach(item => {
          item.addEventListener('click', () => {
            const code = item.dataset.code;
            const dialCode = item.dataset.dial;
            selectCountry(code, dialCode);
          });
        });
      }
      
      // Select a country
      function selectCountry(code, dialCode) {
        selectedFlag.src = `media/flags/${code}.svg`;
        selectedFlag.alt = `${code.toUpperCase()} Flag`;
        selectedCode.textContent = dialCode;
        phoneCountryCode.value = dialCode;
        
        // Save country selection to cookies
        setCookie('phoneCountrySelection', JSON.stringify({ code: code, dialCode: dialCode }), COOKIE_EXPIRY_DAYS);
        
        closeCountryDropdown();
        
        // Focus the phone input
        phoneInput.focus();
      }
      
      // Toggle country dropdown
      function toggleCountryDropdown() {
        const isOpen = countryDropdown.style.display === 'block';
        
        if (isOpen) {
          closeCountryDropdown();
        } else {
          openCountryDropdown();
        }
      }
      
      // Open country dropdown
      function openCountryDropdown() {
        countryDropdownBackdrop.style.display = 'block';
        countryDropdown.style.display = 'block';
        countrySelector.classList.add('open');
        countrySearch.value = '';
        populateCountryList();
        
        // Body scroll is already prevented by the modal
        
        // Focus search input
        setTimeout(() => {
          countrySearch.focus();
        }, 100);
      }
      
      // Close country dropdown
      function closeCountryDropdown() {
        countryDropdownBackdrop.style.display = 'none';
        countryDropdown.style.display = 'none';
        countrySelector.classList.remove('open');
        
        // Don't restore body scroll here - let the modal handle it
      }
      
      // Event listeners for country selector
      if (countrySelector) {
        countrySelector.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleCountryDropdown();
        });
      }
      
      if (countryDropdownCloseBtn) {
        countryDropdownCloseBtn.addEventListener('click', closeCountryDropdown);
      }
      
      if (countrySearch) {
        countrySearch.addEventListener('input', (e) => {
          populateCountryList(e.target.value);
        });
        
        countrySearch.addEventListener('click', (e) => {
          e.stopPropagation();
        });
      }
      
      if (countryDropdown) {
        countryDropdown.addEventListener('click', (e) => {
          e.stopPropagation();
        });
      }
      
      // Close dropdown when clicking backdrop
      if (countryDropdownBackdrop) {
        countryDropdownBackdrop.addEventListener('click', closeCountryDropdown);
      }
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (countryDropdown && countryDropdown.style.display === 'block') {
          if (!countryDropdown.contains(e.target) && e.target !== countrySelector) {
            closeCountryDropdown();
          }
        }
      });
      
      // Initialize country list
      if (countryList) {
        populateCountryList();
      }
      
      // Load saved country selection
      function loadSavedCountrySelection() {
        const savedSelection = getCookie('phoneCountrySelection');
        if (savedSelection) {
          try {
            const { code, dialCode } = JSON.parse(savedSelection);
            if (code && dialCode) {
              // Update UI with saved country
              selectedFlag.src = `media/flags/${code}.svg`;
              selectedFlag.alt = `${code.toUpperCase()} Flag`;
              selectedCode.textContent = dialCode;
              phoneCountryCode.value = dialCode;
              console.log('📱 Restored country selection:', code, dialCode);
            }
          } catch (e) {
            console.warn('Failed to load saved country selection:', e);
          }
        }
      }
      
      // Load saved country selection on page load
      loadSavedCountrySelection();
      
      // Debug function to test country selection persistence
      window.testCountryPersistence = function() {
        const saved = getCookie('phoneCountrySelection');
        if (saved) {
          const { code, dialCode } = JSON.parse(saved);
          console.log('📱 Saved country selection:', code, dialCode);
          console.log('🔍 Current UI state:');
          console.log('  Flag:', selectedFlag?.src);
          console.log('  Code:', selectedCode?.textContent);
          console.log('  Hidden input:', phoneCountryCode?.value);
        } else {
          console.log('❌ No saved country selection found');
        }
      };
      
      // Debug function to clear saved country selection
      window.clearCountrySelection = function() {
        deleteCookie('phoneCountrySelection');
        console.log('🗑️ Cleared saved country selection');
        console.log('🔄 Refresh the page to see the default country code (US +1)');
      };
      
      // ===== Phone Number Formatting =====
      if (phoneInput) {
        let lastValue = '';
        
        // Handle backspace/delete at parenthesis boundaries
        phoneInput.addEventListener('keydown', (e) => {
          if (e.key === 'Backspace' || e.key === 'Delete') {
            const cursorPos = e.target.selectionStart;
            const currentValue = e.target.value;
            const digits = currentValue.replace(/\D/g, '');
            
            // If we have exactly 3 digits in format (xxx) and cursor is after )
            if (digits.length === 3 && currentValue === '(' + digits + ')' && cursorPos === currentValue.length && e.key === 'Backspace') {
              e.preventDefault();
              // Remove one digit
              const newDigits = digits.slice(0, 2);
              e.target.value = newDigits;
              // Trigger input event to reformat
              e.target.dispatchEvent(new Event('input', { bubbles: true }));
              return;
            }
            
            // If we're at a formatting character position, skip it and delete the digit
            if (e.key === 'Backspace' && cursorPos > 0) {
              const charBefore = currentValue[cursorPos - 1];
              // If character before cursor is ( ) or -, delete the actual digit instead
              if (charBefore === '(' || charBefore === ')' || charBefore === '-') {
                e.preventDefault();
                // Find the actual digit position before the formatting character
                const digitsBeforeCursor = currentValue.substring(0, cursorPos).replace(/\D/g, '');
                if (digitsBeforeCursor.length > 0) {
                  const allDigits = digits;
                  const newDigits = allDigits.slice(0, digitsBeforeCursor.length - 1) + allDigits.slice(digitsBeforeCursor.length);
                  e.target.value = newDigits;
                  e.target.dispatchEvent(new Event('input', { bubbles: true }));
                  
                  // Position cursor correctly after reformatting
                  setTimeout(() => {
                    const newFormatted = e.target.value;
                    const newDigitsBeforeCursor = digitsBeforeCursor.slice(0, -1);
                    let newCursorPos = 0;
                    let digitCount = 0;
                    for (let i = 0; i < newFormatted.length && digitCount < newDigitsBeforeCursor.length; i++) {
                      if (/\d/.test(newFormatted[i])) {
                        digitCount++;
                      }
                      newCursorPos = i + 1;
                    }
                    e.target.setSelectionRange(newCursorPos, newCursorPos);
                  }, 0);
                }
                return;
              }
            }
          }
        });
        
        // Format phone number as (xxx)-xxx-xxxx with up to 20 digits
        phoneInput.addEventListener('input', (e) => {
          // Get only numbers from input
          let value = e.target.value.replace(/\D/g, '');
          
          // Limit to 20 digits
          if (value.length > 20) {
            value = value.slice(0, 20);
          }
          
          // Format the number
          let formattedValue = '';
          
          if (value.length > 0) {
            // Only add parenthesis if we have 1 or more digits
            if (value.length === 1 || value.length === 2) {
              // Just show the digits without parenthesis for easier deletion
              formattedValue = value;
            } else if (value.length === 3) {
              // Show (xxx) when we have exactly 3 digits
              formattedValue = '(' + value + ')';
            } else if (value.length > 3 && value.length <= 6) {
              // (xxx)-xxx
              formattedValue = '(' + value.substring(0, 3) + ')-' + value.substring(3, 6);
            } else if (value.length > 6 && value.length <= 10) {
              // (xxx)-xxx-xxxx
              formattedValue = '(' + value.substring(0, 3) + ')-' + value.substring(3, 6) + '-' + value.substring(6, 10);
            } else if (value.length > 10) {
              // (xxx)-xxx-xxxx-xxxxxxxxxx (for international numbers)
              formattedValue = '(' + value.substring(0, 3) + ')-' + value.substring(3, 6) + '-' + value.substring(6, 10) + '-' + value.substring(10, 20);
            }
          }
          
          // Set the formatted value
          lastValue = formattedValue;
          e.target.value = formattedValue;
          
          // Clear any custom validity message while typing
          e.target.setCustomValidity('');
        });
        
        // Prevent non-numeric input
        phoneInput.addEventListener('keypress', (e) => {
          // Allow: backspace, delete, tab, escape, enter
          if ([8, 9, 27, 13, 46].includes(e.keyCode) || 
              // Allow: Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
              (e.keyCode === 65 && e.ctrlKey === true) ||
              (e.keyCode === 67 && e.ctrlKey === true) ||
              (e.keyCode === 86 && e.ctrlKey === true) ||
              (e.keyCode === 88 && e.ctrlKey === true)) {
            return;
          }
          
          // Ensure that it is a number and stop the keypress if not
          if ((e.key < '0' || e.key > '9') && e.key !== 'Backspace' && e.key !== 'Delete') {
            e.preventDefault();
          }
        });
        
        // Handle paste event to clean pasted data
        phoneInput.addEventListener('paste', (e) => {
          e.preventDefault();
          
          // Get pasted data
          const pastedData = (e.clipboardData || window.clipboardData).getData('text');
          
          // Extract only numbers (up to 20 digits)
          const numbers = pastedData.replace(/\D/g, '').slice(0, 20);
          
          // Format and set value
          let formattedValue = '';
          
          if (numbers.length > 0) {
            if (numbers.length === 1 || numbers.length === 2) {
              formattedValue = numbers;
            } else if (numbers.length === 3) {
              formattedValue = '(' + numbers + ')';
            } else if (numbers.length > 3 && numbers.length <= 6) {
              formattedValue = '(' + numbers.substring(0, 3) + ')-' + numbers.substring(3, 6);
            } else if (numbers.length > 6 && numbers.length <= 10) {
              formattedValue = '(' + numbers.substring(0, 3) + ')-' + numbers.substring(3, 6) + '-' + numbers.substring(6, 10);
            } else if (numbers.length > 10) {
              formattedValue = '(' + numbers.substring(0, 3) + ')-' + numbers.substring(3, 6) + '-' + numbers.substring(6, 10) + '-' + numbers.substring(10, 20);
            }
          }
          
          phoneInput.value = formattedValue;
          
          // Trigger input event for any listeners
          phoneInput.dispatchEvent(new Event('input', { bubbles: true }));
        });
        
        // Add custom validation for minimum digits
        phoneInput.addEventListener('blur', (e) => {
          const digitCount = e.target.value.replace(/\D/g, '').length;
          if (digitCount > 0 && digitCount < 3) {
            e.target.setCustomValidity('Phone number must have at least 3 digits');
          } else {
            e.target.setCustomValidity('');
          }
        });
        
        // Debug function to test phone formatting
        window.testPhoneFormat = function(number) {
          if (phoneInput) {
            phoneInput.value = number;
            phoneInput.dispatchEvent(new Event('input', { bubbles: true }));
            console.log('📱 Phone formatted to:', phoneInput.value);
          }
        };
      }
    })();

    // ===== Affiliate Modal =====
    (function affiliateHandler() {
      // Modal elements
      const affiliateModal = $('#affiliateModal');
      const openAffiliateBtn = $('#openAffiliateBtn');
      const closeAffiliateBtn = $('#closeAffiliateBtn');
      const cancelAffiliateBtn = $('#cancelAffiliateBtn');
      const closeAffiliateSuccessBtn = $('#closeAffiliateSuccessBtn');
      const affiliateForm = $('#affiliateForm');
      const generateLinkBtn = $('#generateLinkBtn');
      const copyLinkBtn = $('#copyLinkBtn');
      const shareLinkBtn = $('#shareLinkBtn');
      const affiliateEmail = $('#affiliateEmail');
      const generatedLink = $('#generatedLink');
      const affiliateStep1 = $('#affiliateStep1');
      const affiliateStep2 = $('#affiliateStep2');

      // Open affiliate modal
      function openAffiliateModal() {
        document.body.style.overflow = 'hidden';
        affiliateModal.setAttribute('aria-hidden', 'false');
        
        // Reset to step 1
        affiliateStep1.style.display = 'block';
        affiliateStep2.style.display = 'none';
        affiliateForm.reset();
        
        // Trigger smooth fade in
        requestAnimationFrame(() => {
          affiliateModal.classList.add('show');
          
          // Animate form elements after container appears (same as client form)
          setTimeout(() => {
            animateAffiliateFormElements();
          }, 700); // Wait for form container to fully appear
        });
      }
      
      // Animate affiliate form elements (same as client form)
      function animateAffiliateFormElements() {
        const formGroups = affiliateForm.querySelectorAll('.form-group');
        const formActions = affiliateForm.querySelector('.form-actions');
        
        // Animate each form group with typing effect
        formGroups.forEach((group, index) => {
          setTimeout(() => {
            // Animate the group container
            group.classList.add('animate-in');
            
            // Animate label and input separately
            const label = group.querySelector('.form-label');
            const input = group.querySelector('.form-input');
            
            if (label) {
              setTimeout(() => {
                label.classList.add('animate-in');
              }, 200);
            }
            
            if (input) {
              setTimeout(() => {
                input.classList.add('animate-in');
                
                // Focus first empty field
                if (index === 0) {
                  setTimeout(() => {
                    affiliateEmail.focus();
                  }, 300);
                }
              }, 400);
            }
          }, index * 300); // Stagger each group by 300ms
        });
        
        // Animate form actions last
        if (formActions) {
          setTimeout(() => {
            formActions.style.opacity = '0';
            formActions.style.transform = 'translateY(20px)';
            formActions.style.transition = 'all 0.6s cubic-bezier(0.16, 1, 0.3, 1)';
            
            requestAnimationFrame(() => {
              formActions.style.opacity = '1';
              formActions.style.transform = 'translateY(0)';
            });
          }, formGroups.length * 300 + 200);
        }
      }

      // Close affiliate modal
      function closeAffiliateModal() {
        affiliateModal.classList.remove('show');
        affiliateModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        // Wait for fade out animation to complete
        setTimeout(() => {
          // Reset to step 1
          affiliateStep1.style.display = 'block';
          affiliateStep2.style.display = 'none';
          affiliateForm.reset();
        }, 500);
      }

      // Generate affiliate link
      function generateAffiliateLink(email) {
        // Get current domain - use the actual domain or fallback to current origin
        let currentDomain = window.location.origin;
        
        // If you want to use a specific domain instead of the current one, replace this:
        // currentDomain = 'https://charlierusso.dev';
        
        const affiliateLink = `${currentDomain}?ref=${encodeURIComponent(email)}`;
        console.log('🔗 Generated affiliate link:', affiliateLink);
        return affiliateLink;
      }
      
      // Display affiliate link with proper formatting
      function displayAffiliateLink(email, link) {
        // Create a user-friendly display version (no encoding for display)
        const displayText = `${window.location.origin}?ref=${email}`;
        console.log('🔗 Display text:', displayText);
        return displayText;
      }

      // Copy link to clipboard
      async function copyToClipboard(text) {
        try {
          // Use the properly encoded link for copying (stored in dataset)
          const actualLink = generatedLink.dataset.actualLink || text;
          await navigator.clipboard.writeText(actualLink);
          
          // Show success feedback
          const originalText = copyLinkBtn.textContent;
          copyLinkBtn.textContent = 'Copied!';
          copyLinkBtn.style.background = 'var(--status-success)';
          
          setTimeout(() => {
            copyLinkBtn.textContent = originalText;
            copyLinkBtn.style.background = 'var(--btn-form-bg)';
          }, 2000);
        } catch (err) {
          console.error('Failed to copy: ', err);
          
          // Fallback for older browsers
          const actualLink = generatedLink.dataset.actualLink || text;
          const textArea = document.createElement('textarea');
          textArea.value = actualLink;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          
          // Show success feedback
          const originalText = copyLinkBtn.textContent;
          copyLinkBtn.textContent = 'Copied!';
          copyLinkBtn.style.background = 'var(--status-success)';
          
          setTimeout(() => {
            copyLinkBtn.textContent = originalText;
            copyLinkBtn.style.background = 'var(--btn-form-bg)';
          }, 2000);
        }
      }

      // Share link
      function shareLink() {
        // Use the actual encoded link for sharing (stored in dataset)
        const link = generatedLink.dataset.actualLink || generatedLink.textContent;
        
        if (navigator.share) {
          // Use native sharing if available
          navigator.share({
            title: 'Charlie Russo Technical Services - Affiliate Link',
            text: 'Check out Charlie Russo Technical Services for development and prototyping needs!',
            url: link
          }).catch(err => {
            console.log('Error sharing:', err);
            copyToClipboard(link);
          });
        } else {
          // Fallback to copying
          copyToClipboard(link);
        }
      }

      // Handle form submission
      function handleAffiliateForm(e) {
        e.preventDefault();
        
        const email = affiliateEmail.value.trim();
        
        if (!email || !isValidEmail(email)) {
          alert('Please enter a valid email address.');
          return;
        }
        
        // Generate affiliate link (encoded for actual use)
        const link = generateAffiliateLink(email);
        console.log('🔍 Generated encoded link:', link);
        
        // Create display version (with proper @ symbol)
        const displayLink = displayAffiliateLink(email, link);
        console.log('🔍 Display link:', displayLink);
        
        // Set the display text content
        generatedLink.textContent = displayLink;
        
        // Store the actual encoded link for copying
        generatedLink.dataset.actualLink = link;
        
        // Verify the link was set
        console.log('🔍 Link text content after setting:', generatedLink.textContent);
        
        // Show step 2
        affiliateStep1.style.display = 'none';
        affiliateStep2.style.display = 'block';
        
        // Log affiliate signup (for your tracking)
        console.log('🎯 New affiliate signup:', email);
        console.log('🔗 Generated affiliate link:', link);
      }

      // Email validation helper
      function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      // Event listeners
      openAffiliateBtn.addEventListener('click', openAffiliateModal);
      closeAffiliateBtn.addEventListener('click', closeAffiliateModal);
      cancelAffiliateBtn.addEventListener('click', closeAffiliateModal);
      closeAffiliateSuccessBtn.addEventListener('click', closeAffiliateModal);
      affiliateForm.addEventListener('submit', handleAffiliateForm);
      copyLinkBtn.addEventListener('click', () => {
        // Use the actual encoded link for copying (stored in dataset)
        const actualLink = generatedLink.dataset.actualLink || generatedLink.textContent;
        copyToClipboard(actualLink);
      });
      shareLinkBtn.addEventListener('click', shareLink);

      // Close modal when clicking outside
      affiliateModal.addEventListener('click', (e) => {
        if (e.target === affiliateModal) closeAffiliateModal();
      });

      // Close modal with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (affiliateModal.classList.contains('show')) {
            closeAffiliateModal();
          }
        }
      });

      // Debug function to test affiliate link generation
      window.testAffiliateLink = function(email) {
        if (!email) email = 'test@example.com';
        const link = generateAffiliateLink(email);
        console.log('🧪 Test affiliate link for', email, ':', link);
        console.log('🧪 Current domain:', window.location.origin);
        console.log('🧪 Generated link:', link);
        return link;
      };
      
      // Debug function to test the full affiliate flow
      window.testAffiliateFlow = function(email) {
        if (!email) email = 'test@example.com';
        console.log('🧪 Testing full affiliate flow with email:', email);
        
        // Test link generation
        const link = generateAffiliateLink(email);
        console.log('🧪 Generated link:', link);
        
        // Test setting the link in the text element
        if (generatedLink) {
          generatedLink.textContent = link;
          console.log('🧪 Link set in text element:', generatedLink.textContent);
        } else {
          console.log('🧪 Generated link element not found');
        }
        
        return link;
      };

      // Debug function to test QR code with referral
      window.testQRWithReferral = function(email) {
        if (!email) email = 'test@example.com';
        console.log('🧪 Testing QR code with referral:', email);
        
        // Simulate referral URL
        const newUrl = new URL(window.location);
        newUrl.searchParams.set('ref', email);
        window.history.replaceState({}, document.title, newUrl.toString());
        
        // Generate QR code
        generateQRCode();
        
        console.log('✅ QR code updated with referral URL:', newUrl.toString());
        return newUrl.toString();
      };

      // Debug function to test complete referral + QR system
      window.testCompleteReferralSystem = function(email) {
        if (!email) email = 'test@example.com';
        console.log('🧪 Testing complete referral + QR system with email:', email);
        
        // Step 1: Generate affiliate link
        const affiliateLink = generateAffiliateLink(email);
        console.log('🔗 Generated affiliate link:', affiliateLink);
        
        // Step 2: Simulate visiting the affiliate link
        const newUrl = new URL(window.location);
        newUrl.searchParams.set('ref', email);
        window.history.replaceState({}, document.title, newUrl.toString());
        
        // Step 3: Update referral tracking
        handleReferralTracking();
        
        // Step 4: Generate QR code
        generateQRCode();
        
        // Step 5: Verify everything works
        const currentReferrer = getReferrer();
        console.log('✅ Current referrer detected:', currentReferrer);
        console.log('✅ QR code should now contain referral URL');
        
        return {
          affiliateLink: affiliateLink,
          currentUrl: newUrl.toString(),
          referrer: currentReferrer
        };
      };
    })();
  </script>
</body>
</html>
